<mxfile host="app.diagrams.net">
  <diagram name="Kiến trúc tổng thể - MoviePage" id="arch-movie-page">
    <mxGraphModel dx="1434" dy="764" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="Hình 3.x. Kiến trúc tổng thể phân hệ MoviePage (Frontend – API – MongoDB)" style="text;html=1;align=center;verticalAlign=middle;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="250" y="30" width="700" height="40" as="geometry"/>
        </mxCell>

        <!-- Subtitle -->
        <mxCell id="subtitle" value="NMN Cinema Website - Phân hệ 3: Trang Phim Đang Chiếu / Sắp Chiếu" style="text;html=1;align=center;verticalAlign=middle;rounded=0;fontSize=14;fontStyle=2;fontColor=#666666" parent="1" vertex="1">
          <mxGeometry x="350" y="65" width="500" height="30" as="geometry"/>
        </mxCell>

        <!-- Frontend -->
        <mxCell id="frontend" value="&lt;b style=&quot;font-size: 14px;&quot;&gt;Frontend&lt;/b&gt;&lt;br&gt;(React + Vite)&lt;br&gt;&lt;br&gt;- MoviesPage.jsx&lt;br&gt;- MovieCard.jsx&lt;br&gt;- TrailerModal.jsx&lt;br&gt;- movieApi.js (Axios)&lt;br&gt;&lt;br&gt;&lt;i&gt;States:&lt;/i&gt;&lt;br&gt;• activeTab&lt;br&gt;• loading / tabLoading&lt;br&gt;• trailerOpen / selectedMovie" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2.5;align=center;verticalAlign=top;spacingTop=10;arcSize=10;" parent="1" vertex="1">
          <mxGeometry x="80" y="140" width="280" height="260" as="geometry"/>
        </mxCell>

        <!-- Backend -->
        <mxCell id="backend" value="&lt;b style=&quot;font-size: 14px;&quot;&gt;Backend API&lt;/b&gt;&lt;br&gt;(Node.js + Express)&lt;br&gt;&lt;br&gt;- MovieController&lt;br&gt;  • getNowShowingMovies()&lt;br&gt;  • getComingSoonMovies()&lt;br&gt;- MovieService&lt;br&gt;  • findByStatus(status)&lt;br&gt;&lt;br&gt;&lt;i&gt;Endpoint:&lt;/i&gt;&lt;br&gt;GET /api/v1/movies&lt;br&gt;?status=NOW|COMING&lt;br&gt;&amp;amp;limit=50" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2.5;align=center;verticalAlign=top;spacingTop=10;arcSize=10;" parent="1" vertex="1">
          <mxGeometry x="480" y="140" width="280" height="260" as="geometry"/>
        </mxCell>

        <!-- Database -->
        <mxCell id="database" value="&lt;b style=&quot;font-size: 14px;&quot;&gt;MongoDB&lt;/b&gt;&lt;br&gt;&lt;br&gt;- movies&lt;br&gt;  • title&lt;br&gt;  • status (NOW/COMING)&lt;br&gt;  • posterUrl&lt;br&gt;  • trailerUrl&lt;br&gt;  • rating&lt;br&gt;  • ageRating&lt;br&gt;&lt;br&gt;- genres&lt;br&gt;- persons (actors/director)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2.5;align=center;verticalAlign=top;spacingTop=20;" parent="1" vertex="1">
          <mxGeometry x="880" y="140" width="220" height="260" as="geometry"/>
        </mxCell>

        <!-- Arrow: Frontend <-> Backend (Request) -->
        <mxCell id="arrow1-top" value="&lt;b&gt;HTTP/REST&lt;/b&gt;&lt;br&gt;GET /api/v1/movies&lt;br&gt;?status=NOW&amp;amp;limit=50" style="endArrow=classic;html=1;strokeWidth=2;exitX=1;exitY=0.35;exitDx=0;exitDy=0;entryX=0;entryY=0.35;entryDx=0;entryDy=0;fontSize=11;strokeColor=#6c8ebf;" parent="1" source="frontend" target="backend" edge="1">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="5" as="offset"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow1-bottom" value="&lt;b&gt;JSON Response&lt;/b&gt;&lt;br&gt;{status, data: {movies:[]}}" style="endArrow=classic;html=1;strokeWidth=2;exitX=0;exitY=0.65;exitDx=0;exitDy=0;entryX=1;entryY=0.65;entryDx=0;entryDy=0;fontSize=11;strokeColor=#82b366;" parent="1" source="backend" target="frontend" edge="1">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="-5" as="offset"/>
          </mxGeometry>
        </mxCell>

        <!-- Arrow: Backend <-> Database -->
        <mxCell id="arrow2-top" value="&lt;b&gt;Query&lt;/b&gt;&lt;br&gt;find({status: &quot;NOW&quot;})&lt;br&gt;.limit(50)" style="endArrow=classic;html=1;strokeWidth=2;exitX=1;exitY=0.35;exitDx=0;exitDy=0;entryX=0;entryY=0.35;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=11;strokeColor=#82b366;" parent="1" source="backend" target="database" edge="1">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="5" as="offset"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow2-bottom" value="&lt;b&gt;Result&lt;/b&gt;&lt;br&gt;Movie Documents[]" style="endArrow=classic;html=1;strokeWidth=2;exitX=0;exitY=0.65;exitDx=0;exitDy=0;exitPerimeter=0;entryX=1;entryY=0.65;entryDx=0;entryDy=0;fontSize=11;strokeColor=#d6b656;" parent="1" source="database" target="backend" edge="1">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="-5" as="offset"/>
          </mxGeometry>
        </mxCell>

        <!-- Description boxes below each component -->
        <mxCell id="fe-desc" value="&lt;b&gt;Chức năng:&lt;/b&gt;&lt;br&gt;• Hiển thị danh sách phim (grid)&lt;br&gt;• Tabs: Đang chiếu / Sắp chiếu&lt;br&gt;• Loading screen + Skeleton&lt;br&gt;• Xem trailer modal (YouTube)&lt;br&gt;• Navigate đến trang đặt vé" style="text;html=1;align=left;verticalAlign=top;rounded=1;fillColor=#e1f5fe;strokeColor=#b3e0fc;fontSize=11;spacingLeft=8;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="80" y="420" width="280" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="be-desc" value="&lt;b&gt;Chức năng:&lt;/b&gt;&lt;br&gt;• Xử lý request lấy phim&lt;br&gt;• Lọc theo status (NOW/COMING)&lt;br&gt;• Giới hạn kết quả (limit)&lt;br&gt;• Populate thông tin genres&lt;br&gt;• Trả về chuẩn hóa JSON" style="text;html=1;align=left;verticalAlign=top;rounded=1;fillColor=#e8f5e9;strokeColor=#c8e6c9;fontSize=11;spacingLeft=8;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="480" y="420" width="280" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="db-desc" value="&lt;b&gt;Collections:&lt;/b&gt;&lt;br&gt;• movies: thông tin phim&lt;br&gt;• genres: thể loại phim&lt;br&gt;• persons: đạo diễn, diễn viên&lt;br&gt;&lt;br&gt;&lt;i&gt;Index: status, releaseDate&lt;/i&gt;" style="text;html=1;align=left;verticalAlign=top;rounded=1;fillColor=#fffde7;strokeColor=#fff9c4;fontSize=11;spacingLeft=8;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="880" y="420" width="220" height="110" as="geometry"/>
        </mxCell>

        <!-- Flow Indicator -->
        <mxCell id="flow-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#f48fb1;strokeWidth=1.5" parent="1" vertex="1">
          <mxGeometry x="80" y="560" width="1020" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="flow-title" value="&lt;b&gt;Luồng xử lý chính (Main Flow)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="80" y="565" width="1020" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="flow-step1" value="1. User truy cập&lt;br&gt;/phim-dang-chieu" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="600" width="120" height="50" as="geometry"/>
        </mxCell>

        <mxCell id="flow-arrow1" value="" style="endArrow=classic;html=1;strokeWidth=2" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="220" y="625" as="sourcePoint"/>
            <mxPoint x="260" y="625" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow-step2" value="2. Loading&lt;br&gt;Screen hiển thị" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#4fc3f7;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="260" y="600" width="120" height="50" as="geometry"/>
        </mxCell>

        <mxCell id="flow-arrow2" value="" style="endArrow=classic;html=1;strokeWidth=2" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="380" y="625" as="sourcePoint"/>
            <mxPoint x="420" y="625" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow-step3" value="3. Gọi API&lt;br&gt;GET movies" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="420" y="600" width="120" height="50" as="geometry"/>
        </mxCell>

        <mxCell id="flow-arrow3" value="" style="endArrow=classic;html=1;strokeWidth=2" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="625" as="sourcePoint"/>
            <mxPoint x="580" y="625" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow-step4" value="4. Query&lt;br&gt;MongoDB" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="580" y="600" width="120" height="50" as="geometry"/>
        </mxCell>

        <mxCell id="flow-arrow4" value="" style="endArrow=classic;html=1;strokeWidth=2" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="700" y="625" as="sourcePoint"/>
            <mxPoint x="740" y="625" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow-step5" value="5. Response&lt;br&gt;movies[]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="740" y="600" width="120" height="50" as="geometry"/>
        </mxCell>

        <mxCell id="flow-arrow5" value="" style="endArrow=classic;html=1;strokeWidth=2" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="860" y="625" as="sourcePoint"/>
            <mxPoint x="900" y="625" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow-step6" value="6. Render&lt;br&gt;MovieCard Grid" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="900" y="600" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=1.5" parent="1" vertex="1">
          <mxGeometry x="80" y="690" width="500" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="legend-title" value="&lt;b&gt;Chú thích&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="80" y="695" width="500" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="legend-fe" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2" parent="1" vertex="1">
          <mxGeometry x="100" y="730" width="30" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="legend-fe-text" value="Frontend (React)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="140" y="725" width="110" height="30" as="geometry"/>
        </mxCell>

        <mxCell id="legend-be" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2" parent="1" vertex="1">
          <mxGeometry x="260" y="730" width="30" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="legend-be-text" value="Backend (Express)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="300" y="725" width="120" height="30" as="geometry"/>
        </mxCell>

        <mxCell id="legend-db" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2" parent="1" vertex="1">
          <mxGeometry x="430" y="730" width="30" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="legend-db-text" value="Database (MongoDB)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="470" y="725" width="130" height="30" as="geometry"/>
        </mxCell>

        <mxCell id="legend-arrow" value="" style="endArrow=classic;html=1;strokeWidth=2" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="100" y="770" as="sourcePoint"/>
            <mxPoint x="180" y="770" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-arrow-text" value="Request/Response flow" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="190" y="760" width="150" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="legend-note" value="• Route URL: /phim-dang-chieu, /phim-sap-chieu  •  API: /api/v1/movies?status=NOW|COMING" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="350" y="765" width="400" height="20" as="geometry"/>
        </mxCell>

        <!-- Technology Stack Box -->
        <mxCell id="tech-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#90caf9;strokeWidth=1.5" parent="1" vertex="1">
          <mxGeometry x="610" y="690" width="490" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="tech-title" value="&lt;b&gt;Technology Stack&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="610" y="695" width="490" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="tech-content" value="&lt;table style='font-size:11px;'&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Frontend:&lt;/b&gt;&lt;/td&gt;&lt;td&gt;React 18, Vite, MUI, React Router&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Backend:&lt;/b&gt;&lt;/td&gt;&lt;td&gt;Node.js, Express, Mongoose ODM&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Database:&lt;/b&gt;&lt;/td&gt;&lt;td&gt;MongoDB (Atlas/Local)&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;API:&lt;/b&gt;&lt;/td&gt;&lt;td&gt;RESTful JSON, Axios HTTP Client&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;spacingLeft=15;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="620" y="720" width="470" height="65" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
