<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2026-01-13T06:26:52.000Z" agent="Mozilla/5.0" version="22.1.0" type="device">
  <diagram name="Kiến trúc GenresPage" id="genres-page-architecture">
    <mxGraphModel dx="1434" dy="780" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="&lt;b&gt;SƠ ĐỒ KIẾN TRÚC TỔNG THỂ PHÂN HỆ GENRESPAGE&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;" vertex="1" parent="1">
          <mxGeometry x="284" y="20" width="600" height="30" as="geometry" />
        </mxCell>

        <!-- ==================== FRONTEND LAYER ==================== -->
        <mxCell id="frontend-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="40" y="70" width="350" height="340" as="geometry" />
        </mxCell>
        <mxCell id="frontend-label" value="&lt;b&gt;FRONTEND (ReactJS)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontColor=#1a5276;" vertex="1" parent="1">
          <mxGeometry x="115" y="80" width="200" height="25" as="geometry" />
        </mxCell>

        <!-- GenresPage Component -->
        <mxCell id="genres-page" value="&lt;b&gt;GenresPage.jsx&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:10px;&#39;&gt;• Hiển thị danh sách bài viết (Grid/Card)&lt;br&gt;• Bộ lọc: Thể loại, Quốc gia, Năm, Trạng thái&lt;br&gt;• Dropdown Sắp xếp&lt;br&gt;• Thanh phân trang (Pagination)&lt;br&gt;• Sidebar phim đang chiếu&lt;br&gt;• Xử lý sự kiện: Filter, Like, Navigate&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=center;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="60" y="115" width="220" height="130" as="geometry" />
        </mxCell>

        <!-- State Management -->
        <mxCell id="state-mgmt" value="&lt;b&gt;State Management&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:10px;&#39;&gt;• genres[] - Danh sách bài viết&lt;br&gt;• filters - Bộ lọc hiện tại&lt;br&gt;• currentPage, totalPages&lt;br&gt;• likeStates - Trạng thái Thích&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=center;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="60" y="260" width="150" height="90" as="geometry" />
        </mxCell>

        <!-- API Client -->
        <mxCell id="api-client" value="&lt;b&gt;genreApi.js&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:10px;&#39;&gt;• getAllGenresAPI()&lt;br&gt;• getCategoriesAPI()&lt;br&gt;• toggleGenreLikeAPI()&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=center;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="225" y="260" width="145" height="90" as="geometry" />
        </mxCell>

        <!-- User Actor -->
        <mxCell id="user-actor" value="" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="300" y="125" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="user-label" value="User" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="295" y="185" width="40" height="20" as="geometry" />
        </mxCell>

        <!-- ==================== BACKEND LAYER ==================== -->
        <mxCell id="backend-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="440" y="70" width="300" height="340" as="geometry" />
        </mxCell>
        <mxCell id="backend-label" value="&lt;b&gt;BACKEND API (Node.js/Express)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontColor=#7e5109;" vertex="1" parent="1">
          <mxGeometry x="475" y="80" width="230" height="25" as="geometry" />
        </mxCell>

        <!-- Genre Controller -->
        <mxCell id="genre-controller" value="&lt;b&gt;GenreController&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:10px;&#39;&gt;• getAllGenres(req, res)&lt;br&gt;• getGenreBySlug(req, res)&lt;br&gt;• toggleLike(req, res)&lt;br&gt;• getFilters(req, res)&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=center;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="460" y="115" width="150" height="95" as="geometry" />
        </mxCell>

        <!-- Genre Service -->
        <mxCell id="genre-service" value="&lt;b&gt;GenreService&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:10px;&#39;&gt;• getGenres(filters, pagination)&lt;br&gt;• toggleLike(userId, genreId)&lt;br&gt;• buildFilterQuery()&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=center;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="625" y="115" width="150" height="95" as="geometry" />
        </mxCell>

        <!-- REST Endpoints -->
        <mxCell id="rest-endpoints" value="&lt;b&gt;REST API Endpoints&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:10px;&#39;&gt;GET /api/v1/genres?filters&amp;page&lt;br&gt;GET /api/v1/genres/categories&lt;br&gt;GET /api/v1/genres/countries&lt;br&gt;GET /api/v1/genres/years&lt;br&gt;POST /api/v1/genres/:id/like&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=center;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="460" y="225" width="175" height="100" as="geometry" />
        </mxCell>

        <!-- Middleware -->
        <mxCell id="middleware" value="&lt;b&gt;Middleware&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:10px;&#39;&gt;• authMiddleware&lt;br&gt;• errorHandler&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=center;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="650" y="225" width="130" height="70" as="geometry" />
        </mxCell>

        <!-- ==================== DATABASE LAYER ==================== -->
        <mxCell id="database-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="790" y="70" width="200" height="340" as="geometry" />
        </mxCell>
        <mxCell id="database-label" value="&lt;b&gt;DATABASE (MongoDB)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontColor=#196f3d;" vertex="1" parent="1">
          <mxGeometry x="815" y="80" width="150" height="25" as="geometry" />
        </mxCell>

        <!-- Genres Collection -->
        <mxCell id="genres-collection" value="&lt;b&gt;genres&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:9px;&#39;&gt;_id, name, slug&lt;br&gt;content, thumbnail&lt;br&gt;categoryId, country, year&lt;br&gt;views, likeCount&lt;br&gt;likedBy: [userId]&lt;br&gt;createdAt, updatedAt&lt;/div&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#fff2cc;strokeColor=#d6b656;align=center;verticalAlign=top;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="810" y="115" width="120" height="110" as="geometry" />
        </mxCell>

        <!-- Categories Collection -->
        <mxCell id="categories-collection" value="&lt;b&gt;categories&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:9px;&#39;&gt;_id, name, slug&lt;br&gt;description&lt;/div&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#dae8fc;strokeColor=#6c8ebf;align=center;verticalAlign=top;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="810" y="240" width="120" height="70" as="geometry" />
        </mxCell>

        <!-- Movies Collection (sidebar) -->
        <mxCell id="movies-collection" value="&lt;b&gt;movies&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;div style=&#39;text-align:left;font-size:9px;&#39;&gt;(Sidebar phim đang chiếu)&lt;/div&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#e1d5e7;strokeColor=#9673a6;align=center;verticalAlign=top;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="810" y="320" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- ==================== ARROWS / CONNECTIONS ==================== -->
        <!-- Frontend to Backend -->
        <mxCell id="arrow-fe-be" value="HTTP/REST&lt;br&gt;(JSON)" style="endArrow=classic;startArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#1a5276;" edge="1" parent="1" source="api-client" target="rest-endpoints">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="370" y="290" as="sourcePoint" />
            <mxPoint x="420" y="240" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Backend to Database -->
        <mxCell id="arrow-be-db" value="Mongoose&lt;br&gt;Query" style="endArrow=classic;startArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#196f3d;" edge="1" parent="1" source="genre-service" target="genres-collection">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="750" y="170" as="sourcePoint" />
            <mxPoint x="800" y="170" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Controller to Service -->
        <mxCell id="arrow-ctrl-svc" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=1;dashed=1;" edge="1" parent="1" source="genre-controller" target="genre-service">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="155" as="sourcePoint" />
            <mxPoint x="630" y="155" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- GenresPage to State -->
        <mxCell id="arrow-page-state" value="" style="endArrow=classic;startArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=1;dashed=1;" edge="1" parent="1" source="genres-page" target="state-mgmt">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="120" y="250" as="sourcePoint" />
            <mxPoint x="120" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- GenresPage to API Client -->
        <mxCell id="arrow-page-api" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=1;curved=1;" edge="1" parent="1" source="genres-page" target="api-client">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="260" y="210" as="sourcePoint" />
            <mxPoint x="280" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- User to GenresPage -->
        <mxCell id="arrow-user-page" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=1;" edge="1" parent="1" source="user-actor" target="genres-page">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="290" y="155" as="sourcePoint" />
            <mxPoint x="270" y="155" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- ==================== DATA FLOW NOTES ==================== -->
        <mxCell id="flow-note" value="&lt;b&gt;Luồng dữ liệu:&lt;/b&gt;&lt;br&gt;1. User thay đổi bộ lọc/trang&lt;br&gt;2. GenresPage gọi API với params&lt;br&gt;3. Backend query MongoDB&lt;br&gt;4. Trả JSON (danh sách + pagination)&lt;br&gt;5. Frontend cập nhật UI" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;spacingLeft=5;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="40" y="430" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="like-note" value="&lt;b&gt;Toggle Like:&lt;/b&gt;&lt;br&gt;POST /genres/:id/like&lt;br&gt;→ Kiểm tra JWT token&lt;br&gt;→ Toggle likedBy array&lt;br&gt;→ Cập nhật likeCount&lt;br&gt;→ Trả { liked, likeCount }" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;spacingLeft=5;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="260" y="430" width="180" height="100" as="geometry" />
        </mxCell>

        <!-- Caption -->
        <mxCell id="caption" value="&lt;i&gt;Hình 3.xx. Sơ đồ kiến trúc tổng thể phân hệ GenresPage (Frontend – Backend – MongoDB)&lt;/i&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="284" y="550" width="600" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
