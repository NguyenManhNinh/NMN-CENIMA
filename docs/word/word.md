                       TRƯỜNG ĐẠI HỌC THÀNH ĐÔ
KHOA CÔNG NGHỆ THÔNG TIN

LỜI MỞ ĐẦU
Trong những năm gần đây, ngành công nghiệp điện ảnh và giải trí phát triển mạnh mẽ, kéo theo nhu cầu hiện đại hóa vận hành và nâng cao trải nghiệm khách hàng tại các rạp chiếu phim.
Tuy nhiên, ở nhiều mô hình rạp vừa và nhỏ, việc đặt vé thủ công, quản lý suất chiếu rời rạc và thiếu kênh tương tác hỗ trợ khách hàng vẫn là các “điểm nghẽn”, gây bất tiện và làm giảm hiệu quả vận hành.
Xuất phát từ bối cảnh đó đề tài “Xây dựng Website quản lý rạp chiếu phim tích hợp thanh toán trực tuyến và AI chatbot” được thực hiện nhằm xây dựng một hệ thống website toàn diện: vừa hỗ trợ khách hàng tra cứu thông tin, đặt vé thuận tiện vừa cung cấp công cụ quản trị đầy đủ nghiệp vụ cho rạp chiếu phim. Điểm nhấn của đề tài là hệ thống đặt vé theo thời gian thực, tích hợp cổng thanh toán trực tuyến VNPay và trợ lý ảo AI ChatBot để tự động hóa tư vấn – hỗ trợ, góp phần tối ưu trải nghiệm người dùng và nâng cao hiệu quả vận hành.
Bên cạnh đó, thực tế tại Việt Nam cho thấy nhiều doanh nghiệp đã triển khai hoạt động thương mại hóa trên Internet, nhưng do những khó khăn về cơ sở hạ tầng và dịch vụ chưa tối ưu, không ít mô hình vẫn chỉ dừng ở mức giới thiệu sản phẩm và tiếp cận đơn hàng qua web. Vì vậy, với mong muốn đóng góp thúc đẩy tính ứng dụng của thương mại điện tử trong lĩnh vực giải trí, em đã nghiên cứu và xây dựng sản phẩm theo đề tài trên.
Trong quá trình thực hiện đồ án, em đã nhận được sự hướng dẫn tận tình của thầy Vũ Hoàng Anh. Dù đã cố gắng tìm hiểu, phân tích, thiết kế và cài đặt hệ thống, báo cáo chắc chắn vẫn khó tránh khỏi thiếu sót. Em kính mong nhận được sự thông cảm và các ý kiến góp ý của quý thầy cô để em hoàn thiện hơn. Em xin chân thành cảm ơn.

TÓM TẮT ĐỒ ÁN
Đồ án triển khai hệ thống website quản lý rạp chiếu phim theo mô hình gồm 2 phần chính: (1) Hệ thống dành cho khách hàng và (2) Hệ thống dành cho quản trị viên.Hệ thống hướng đến việc giải quyết bài toán đặt vé trực tuyến và quản lý vận hành rạp một cách đồng bộ,tối ưu và dễ mở rộng.
Về chức năng,phía khách hàng cho phép tìm kiếm và xem chi tiết phim/lịch chiếu,đặt vé thời gian thực với sơ đồ ghế theo trực quan,thanh toán qua VNPay,tích điểm thành viên và tương tác hỏi-đáp thông tin bằng AI chatbot.
Phía quản trị hỗ trợ quản lý vòng đời phim và lịch chiếu,quản lý hệ thống rạp/phòng chiếu/sơ đồ ghế,quản lý khuyến mãi và nội dung CMS (tin tức,FAQ,góp ý),đồng thời cung cấp báo cáo doanh thu và các chỉ số vận hành theo thời gian thực.
Về công nghệ,hệ thống tích hợp AI (Google Gemini 2.5 Flash API) theo hướng RAG để tư vấn chính xác dựa trên dữ liệu phim tại Database,tích hợp thanh toán VNPay và chú trọng an toàn giao dịch (chống trùng lặp).Bên cạnh đó,hệ thống định hướng đảm bảo hiệu năng và bảo mật thông tin qua cơ chế caching/rate limiting và các biện pháp bảo vệ nền tảng web.
Kết quả kỳ vọng của đồ án là tạo ra một nền tảng đặt vé – quản trị rạp chiếu phim có tính ứng dụng thực tế hướng đến người dùng,đáp ứng nhu cầu vận hành cơ bản đến mở rộng (nội dung,khuyến mãi,báo cáo,trợ lý ảo),đồng thời tạo tiền đề để phát triển các tính năng nâng cao trong giai đoạn tiếp theo (mở rộng kênh,làm marketing,tối ưu trải nghiệm,mở rộng tích hợp)
SUMMARY OF PROJECTS
The project implements a cinema management website system based on a model consisting of two main parts: (1) System for customers and (2) System for administrators. The system guides the solution of online ticket booking and cinema operation management in a synchronized, optimized and easily scalable manner.
In terms of functionality, the customer side allows searching and viewing movie details/showtimes, booking tickets in real time with a visual seating chart, paying via VNPay, earning membership points, and interacting with AI chatbots for information and Q&A.
The administration module supports film lifecycle management and screening schedules, theater/screening room/seating layout management, promotion and CMS content management (news, FAQs, feedback), and provides real-time revenue reports and operational metrics.
In terms of technology, the system integrates AI (Google Gemini 2.5 Flash API) in a RAG-oriented manner to provide accurate recommendations based on movie data in the database, integrates VNPay payment, and focuses on transaction security (anti-duplication). In addition, the system is oriented towards ensuring performance and information security through caching/rate limiting mechanisms and web platform protection measures.
The expected outcome of this project is to create a practical, user-oriented cinema ticketing and management platform that meets basic to advanced operational needs (content, promotions, reporting, virtual assistant), while also laying the groundwork for the development of advanced features in the next phase (channel expansion, marketing, user experience optimization, integration expansion).










LỜI MỞ ĐẦU
TÓM TẮT ĐỒ ÁN
CHƯƠNG 1: TỔNG QUAN VỀ ĐỀ TÀI.
1.1. Lý do lựa chọn đề tài.
1.2. Mục đích và phạm vi của đề tài
1.2.1.Mục đích
1.2.2.Phạm vi (Khách hàng,quản trị,kỹ thuật)
1.3. Các nội dung chính của báo cáo
CHƯƠNG 2: CƠ SỞ LÝ THUYẾT
2.1. Tổng quan về thương mại điện tử trong lĩnh vực dịch vụ giải trí
2.1.1.TMĐT trong dịch vụ giải trí
2.1.2.Mô hình bán vé rạp chiếu phim trực tuyến
2.1.3.Lợi ích
2.1.4.Khung pháp lý (Nghị định 52)
2.1.5.Xu hướng phát triển
2.2. Công nghệ chính được sử dụng
2.2.1. Ngôn ngữ HTML
2.2.2.Ngôn ngữ CSS
2.2.3.Ngôn ngữ JavaScript
2.2.4.Mô hình MVC (Khái niệm,thành phần,tương tác)
2.2.5.Công nghệ ReactJS (Frontend)
2.2.6.Công nghệ Node.js (Backend)
2.2.7.Công nghệ MongoDB (NoSQL)
CHƯƠNG 3: PHÂN TÍCH, THIẾT KẾ VÀ TRIỂN KHAI HỆ THỐNG
3.1. Phân tích yêu cầu bài toán
3.2. Thiết kế hệ thống
3.3. Thiết kế cơ sở dữ liệu
3.4. Mô tả hệ thống
3.5. Các bước cài đặt
CHƯƠNG 4: KẾT LUẬN
4.1. Tóm tắt kết quả đạt được
4.2. Kết quả đạt được so với các hệ thống tương tự
4.3. Các ứng dụng thực tế của hệ thống
4.4. Hướng phát triển và nghiên cứu tiếp theo
















Danh sách các từ viết tắt
STT	Chữ viết tắt	Giải thích
1	TMĐT	Thương mại điện tử
2	RAG	Retrieval-Augmented Generation
3
5
6













Danh sách hình vẽ




















CHƯƠNG I.TỔNG QUAN ĐỀ TÀI
1.1.Lý do chọn đề tài
Chuyển đổi số đang trở thành định hướng trọng tâm trong phát triển kinh tế – xã hội tại Việt Nam, hướng tới xây dựng Chính phủ số, kinh tế số, xã hội số, đồng thời thúc đẩy hình thành các doanh nghiệp công nghệ số có năng lực cạnh tranh và vươn ra toàn cầu.
Theo tầm nhìn đến năm 2030, chuyển đổi số hướng tới đổi mới căn bản hoạt động quản lý – điều hành, hoạt động sản xuất kinh doanh của doanh nghiệp và phương thức sống, làm việc của người dân trên môi trường số an toàn, rộng khắp. Trong bối cảnh đó, lĩnh vực dịch vụ – giải trí cũng cần ứng dụng công nghệ để nâng cao trải nghiệm khách hàng và tối ưu vận hành.
Thực tiễn vận hành tại nhiều rạp chiếu phim quy mô vừa và nhỏ cho thấy các nghiệp vụ như quản lý phim – suất chiếu – phòng chiếu, đặt vé và hỗ trợ khách hàng có thể còn rời rạc hoặc phụ thuộc thao tác thủ công, dễ phát sinh bất tiện như khó theo dõi tình trạng ghế theo thời gian thực, quy trình thanh toán thiếu đồng bộ, và hạn chế kênh tư vấn/giải đáp tức thời cho khách hàng.
Vì vậy đề tài “Xây dựng website quản lý rạp chiếu phim tích hợp thanh toán trực tuyến và AI ChatBot” được lựa chọn là như một bài toán ứng dụng chuyển đổi số trong dịch vụ giải trí hướng tới số hóa quy trình đặt vé quản trị tập trung và tăng cường hỗ trợ khách hàng bằng công nghệ
1.2.Mục đích và phạm vị của đề tài
1.2.1. Mục đích
Đồ án hướng tới các mục tiêu chính sau:
Xây dựng website hỗ trợ khách hàng tra cứu thông tin phim/lịch chiếu, đặt vé trực tuyến, chọn ghế trực quan theo thời gian thực và thanh toán online.
Xây dựng hệ thống quản trị hỗ trợ rạp chiếu quản lý tập trung các nghiệp vụ: phim, rạp, phòng chiếu, suất chiếu, vé, đơn hàng, khuyến mãi và theo dõi hoạt động vận hành.
Tích hợp thanh toán trực tuyến nhằm hoàn thiện luồng đặt vé theo hướng số hóa dịch vụ, phù hợp định hướng phát triển kinh tế số.
Tích hợp AI Chatbot hỗ trợ hỏi đáp/tra cứu thông tin, góp phần cải thiện trải nghiệm và giảm tải hỗ trợ thủ công.
Đảm bảo các yêu cầu cơ bản về ổn định và bảo mật trong phạm vi đồ án.
1.2.2. Phạm vi
Phạm vi chức năng phía khách hàng:
Xem danh sách phim, xem chi tiết phim, phân loại phim (đang chiếu/sắp chiếu).
Xem lịch chiếu theo phim/rạp/ngày, lựa chọn suất chiếu.
Chọn ghế theo sơ đồ phòng chiếu, tạo đơn hàng và thanh toán trực tuyến.
Nhận/xem thông tin vé (mã QR) qua email, xem lịch sử đặt vé; áp dụng voucher/khuyến mãi.
Tương tác với AI Chatbot để tra cứu thông tin liên quan.
Phạm vi chức năng phía quản trị:
Quản lý dữ liệu phim (CRUD), poster/banner, trạng thái phim.
Quản lý rạp, phòng chiếu, sơ đồ ghế; quản lý suất chiếu và kiểm tra trùng lịch.
Quản lý đơn hàng, thanh toán, vé; quản lý voucher/combo/khuyến mãi.
Quản lý nội dung CMS cơ bản (bài viết, sự kiện, FAQ, phản hồi).
Báo cáo thống kê cơ bản (doanh thu, top phim, tỷ lệ lấp đầy…).
Phạm vi kỹ thuật:
Hệ thống phát triển theo mô hình web, frontend và backend tách rời.
CSDL MongoDB; backend Node.js/Express; frontend ReactJS.
Tích hợp VNPay và AI Chatbot (Gemini) trong phạm vi demo/đồ án.
Triển khai Docker phục vụ kiểm thử và trình bày.
1.3.Các nội dung chính của báo cáo
      Chương 1:Tổng quan về đề tài
Trình bày bối cảnh chuyển đổi số và sự cần thiết áp dụng trong dịch vụ; nêu lý do chọn đề tài, mục tiêu và phạm vi triển khai; xác định đối tượng sử dụng (khách hàng, quản trị) và phạm vi kỹ thuật của hệ thống.
Chương 2:Cơ sở lý thuyết
Trình bày tổng quan nghiệp vụ đặt vé trực tuyến và các thành phần công nghệ sử dụng; mô tả kiến trúc hệ thống và cơ sở lựa chọn stack; giới thiệu cơ chế tích hợp các dịch vụ như realtime, thanh toán trực tuyến và AI chatbot.
Chương 3:Phân tích,thiết kế và triển khai hệ thống
Phân tích yêu cầu chức năng/phi chức năng; thiết kế kiến trúc, cơ sở dữ liệu, các sơ đồ UML; mô tả hiện thực chức năng và triển khai hệ thống trong môi trường chạy thử (Docker).
Chương 4:Kết luận
Tổng kết kết quả đạt được so với mục tiêu; đánh giá ưu điểm và hạn chế; đề xuất định hướng phát triển và mở rộng trong tương lai.
CHƯƠNG 2: CƠ SỞ LÝ THUYẾT
2.1.Tổng quan về thương mại điện tử trong lĩnh vực dịch vụ giải trí
Theo Nghị định 52/2013/NĐ-CP, hoạt động thương mại điện tử được hiểu là việc tiến hành một phần hoặc toàn bộ quy trình của hoạt động thương mại bằng phương tiện điện tử có kết nối Internet, mạng viễn thông di động hoặc các mạng mở khác.
Trong phạm vi dịch vụ giải trí, bán vé xem phim trực tuyến có thể được xem là một dạng cung ứng dịch vụ thông qua website/ứng dụng, khi người dùng thực hiện các bước lựa chọn dịch vụ, xác nhận thông tin, đặt chỗ và thanh toán qua môi trường mạng. Hệ thống bán vé vì vậy cần được thiết kế theo hướng đáp ứng các nguyên tắc về cung cấp thông tin minh bạch, giao kết hợp đồng trực tuyến, an toàn thanh toán và bảo vệ dữ liệu cá nhân theo định hướng quản lý trong Nghị định.
2.1.1.Thương mại điện tử trong lĩnh vực dịch vụ giải trí
Bán vé rạp phim online là một trường hợp điển hình của thương mại điện tử trong nhóm dịch vụ: người dùng tra cứu thông tin, lựa chọn suất chiếu/ghế và thực hiện giao dịch trên môi trường số. Theo Nghị định 52/2013/NĐ-CP, chủ thể tham gia hoạt động thương mại điện tử có thể là thương nhân/tổ chức/cá nhân tự thiết lập website để bán hàng hóa hoặc cung ứng dịch vụ, hoặc đơn vị cung cấp nền tảng cho bên khác tham gia.
Vì là dịch vụ có thời điểm sử dụng cụ thể (suất chiếu), hệ thống bán vé cần đặc biệt chú trọng quản lý thông tin giao dịch và quy trình xác nhận để hạn chế nhầm lẫn, đồng thời công khai đầy đủ điều kiện giao dịch và thông tin liên quan đến dịch vụ.
2.1.2.Mô hình bán vé rạp phim trực tuyến
Một mô hình bán vé rạp phim trực tuyến thường triển khai theo các bước logic sau:
1.	Tra cứu – lựa chọn dịch vụ: người dùng xem phim, rạp, lịch chiếu, chọn suất chiếu.
2.	Đặt chỗ/đặt vé trực tuyến: hệ thống ghi nhận yêu cầu đặt dịch vụ và chuẩn bị thông tin giao dịch.
3.	Xác nhận thông tin giao dịch: trước khi thanh toán, hệ thống cần cho người dùng rà soát, xác nhận các thông tin quan trọng của giao dịch (đặc biệt khi có thanh toán trực tuyến).
4.	Thanh toán: hệ thống công bố rõ phương thức thanh toán, giải thích để người dùng hiểu và lựa chọn.
5.	Xác nhận giao kết: khi website có chức năng đặt hàng/đặt dịch vụ trực tuyến, thời điểm giao kết được xác định theo cơ chế trả lời chấp nhận đề nghị giao kết của bên bán/cung ứng dịch vụ.
Ngoài ra, nếu website áp dụng điều kiện giao dịch chung (đổi/hoàn, quy định độ tuổi, điều kiện sử dụng dịch vụ…), hệ thống cần có cơ chế để khách hàng đọc và thể hiện sự đồng ý trước khi gửi đề nghị giao kết.
2.1.3.Lợi tích của bán vé rạp phim online
Đối với khách hàng
Tiếp cận thông tin rõ ràng, dễ tìm, dễ hiểu trước khi thực hiện giao dịch.
Chủ động lựa chọn phương thức thanh toán; có bước rà soát/xác nhận thông tin trước khi thanh toán trực tuyến.
Đối với rạp chiếu phim/đơn vị vận hành
Chuẩn hóa quy trình cung cấp thông tin dịch vụ, điều kiện giao dịch và cơ chế thanh toán theo yêu cầu công khai minh bạch trên website.
Hỗ trợ quản lý tập trung dữ liệu giao dịch và trách nhiệm pháp lý rõ ràng trong hoạt động cung ứng dịch vụ qua môi trường mạng.

2.1.4.Khung pháp lý và yêu cầu đối với hệ thống bán vé trực tuyến tại Việt Nam
 Theo Nghị định 52/2013/NĐ-CP, website thương mại điện tử bán hàng/cung ứng dịch vụ có trách nhiệm:
Cung cấp đầy đủ thông tin về chủ sở hữu website, hàng hóa/dịch vụ và các điều khoản giao dịch; thông tin phải rõ ràng, chính xác, dễ tìm, dễ hiểu, có khả năng lưu trữ/in/hiển thị lại, và được hiển thị cho khách hàng trước thời điểm gửi đề nghị giao kết.
Công bố các phương thức thanh toán kèm giải thích rõ ràng; nếu có thanh toán trực tuyến thì phải có cơ chế để khách hàng rà soát và xác nhận thông tin chi tiết của từng giao dịch trước khi thanh toán.
Bảo vệ thông tin cá nhân người tiêu dùng: xây dựng và công bố chính sách bảo vệ dữ liệu (mục đích thu thập, phạm vi sử dụng, thời gian lưu trữ, bên được tiếp cận, đơn vị quản lý dữ liệu, cách người dùng chỉnh sửa dữ liệu…), đồng thời hiển thị rõ ràng cho người dùng trước hoặc tại thời điểm thu thập.
Có cơ chế xin phép người tiêu dùng khi thu thập thông tin (và cơ chế lựa chọn đồng ý/không đồng ý với một số trường hợp sử dụng dữ liệu).
2.1.5.Xu hướng phát triển
Trong bối cảnh các giao dịch dịch vụ được thực hiện ngày càng nhiều trên môi trường mạng, xu hướng phát triển các hệ thống bán vé trực tuyến cần tập trung vào các trụ cột phù hợp với yêu cầu quản lý của Nghị định 52/2013/NĐ-CP:
Minh bạch hóa thông tin dịch vụ và điều kiện giao dịch trước khi người dùng đặt vé.
Tăng cường an toàn và kiểm soát giao dịch thanh toán, đảm bảo người dùng được rà soát/xác nhận đầy đủ nội dung thanh toán.
Chuẩn hóa chính sách và cơ chế bảo vệ dữ liệu cá nhân và quyền kiểm soát dữ liệu của người dùng.
Tóm lại, việc xây dựng hệ thống bán vé rạp phim online cần vừa đáp ứng yêu cầu kỹ thuật của một nền tảng dịch vụ trực tuyến, vừa phản ánh đầy đủ các yêu cầu quan trọng về công khai thông tin, thanh toán và dữ liệu cá nhân theo Nghị định 52/2013/NĐ-CP.
2.2. Công nghệ chính được sử dụng ( ReactJS,Node,MongoDB )
2.2.1. Ngôn ngữ HTML

                               Hình 2.1.Ngôn ngữ HTML
HyperText Markup Language – ngôn ngữ siêu văn bản là một trong các loại ngôn ngữ được sử dụng trong lập trình web. Khi truy cập một trang web cụ thể là click vào các đường link, bạn sẽ được dẫn tới nhiều trang các nhau, và các trang này được gọi là một tài liệu HTML (tập tin HTML).
HTML là ngôn ngữ lập trình web được đánh giá là đơn giản. Mọi trang web, mọi trình duyệt web đều có thể hiển thị tốt ngôn ngữ HTML. Hiện nay, phiên bản mới nhất của HTML là HTML5 với nhiều tính năng tốt và chất lượng hơn so với các phiên bản HTML cũ.
HTML giúp cấu thành các cấu trúc cơ bản trên một website (chia khung sườn, bố cục các thành phần trang web) và góp phần hỗ trợ khai báo các tập tin kĩ thuật số như video, nhạc, hình ảnh.
Các trang HTML được quy định bằng các thẻ tag. Những thẻ này được chứa trong các dấu ngoặc đơn dạng: <tên thẻ>. Trừ một vài thẻ đặc biệt, hầu hết các thẻ cơ bản đều có các thẻ đóng tương ứng với nó. Ví dụ, thẻ <html> có thẻ đóng tương ứng là </html>, thẻ <body> có thẻ đóng tương ứng là </body>.
Lịch sử ngôn ngữ HTML
Cha đẻ của HTML là Tim Berners – Lee – nhà vật lý học, là người nghĩ ra ý tưởng dựa trên hệ thống hypertext trên nền internet.
Năm 1991, xuất bản phiên bản đầu tiên của HTML gồm 18 tag HTML.
Năm 1998, HTML phiên bản 4.01 ra đời.
Năm 2000, các phiên bản HTML được thay thế bằng XHTML.
Năm 2014, HTML được nâng cấp lên HTML5 với sự cải tiến rõ rệt.
2.2.2.Ngôn ngữ CSS

				 Hình 2.2:Ngôn ngữ CSS
CSS là viết tắt của cụm từ “Cascading Style Sheets” - ngôn ngữ tạo phong cách cho trang web. Ngôn ngữ lập trình này quy định cách các thành phần HTML của trang web thực sự sẽ xuất hiện trên frontend như thế nào.
CSS sẽ giúp webmaster xác định styles và định nghĩa nhiều loại nội dung của website. CSS được tạo ra để kết hợp với ngôn ngữ markup HTML để tạo phong cách cho trang web. Có 3 loại style CSS chính:
-	Style CSS Internal: là style được tải lên mỗi khi trang web được refresh.
-	Style CSS Inline: bạn có thể chỉnh sửa một yếu tố nào đó mà không cần truy cập trực tiếp vào file CSS.
-	External style: bạn có thể tạo phong cách ở file khác áp dụng CSS vào trang bạn muốn. External style sẽ cải thiện thời gian tải trang rất nhiều.
Ưu điểm của CSS – Khả năng tiết kiệm thời gian
CSS khi sử dụng có thể viết lần đầu, đồng thời sử dụng lại trong các trang HTML tiếp theo. KHông chỉ vây, cḥúng ta hoàn toàn có thể xác định được môt kịểu cho từng thành phần HTML và cũng áp dụng được cho nhiều trang web khác khi cần thiết.
-CSS giúp khả năng tải trang nhanh chóng
Đăc trưng c̣ủa CSS khi sử dụng là ít mã hơn. Bởi thế mà thời gian tải xuống nhanh chóng, giúp tiết kiêm tḥời gian đáng kể. Khi viết được môt quy ṭắc CSS của môt tḥ	ẻ cụ thể và lúc này chúng ta có thể áp dụng nó cho mọi lần xuất hiên tịếp theo của thẻ đó, đồng thời hoàn toàn không cần tiến hành thay đổi thuôc ṭính của thẻ HTML.
-Dễ dàng khi thực hiện bảo trì
Khi cần chúng ta chỉ cần thay đổi môt kịểu và mọi thành phần trong tất cả những website thì lúc này CSS sẽ hỗ trợ câp nhật họàn toàn tự đông.̣
-CSS sở hữu thuộc tính rộng
CSS được đánh giá cao nhờ sở hữu những thuôc ṭ ính rông hơn ṇ ếu đánh giá và so sánh với HTML.
-Khả năng tương thích tốt
Khả năng tương thích với nhiều thiết bị cũng là ưu điểm của CSS. Cùng sử dụng môt ṭ ài liêu HTML song ṿới nhiều phiên bản website khác nhau được trình bày ở từng thiết bị di động đ̣ều được hỗ trợ tốt, có độ tương tḥ	ích cao.
-Nhược điểm của CSS
Cùng với những ưu điểm thì CSS khi đưa vào sử dụng còn tồn tại những hạn chế nhất định. Trước khi ứng dụng đòi hỏi chúng ta phải tìm hiểu môt c̣ách đầy đủ và chi tiết.
-CSS hoạt động khác biệt cho từng trình duyệt
Với những thay đổi ban đầu của CSS trên môt website ṛ	ất dễ dàng. Tuy nhiên, khi thay đổi đã được thực hiên đ̣òi hỏi chúng ta phải xác nhân đựợc tính tương thích khi CSS hiển thị hiêu ̣ ứng thay đổi tương tự cho từng trình duyêt. Địều này xuất hiên do CSS ṣẽ hoạt đông kḥác biêt cho ṭừng trình duyêt c̣ụ thể.
-Khá khó khăn cho người mới
Ngôn ngữ lâp tṛình phát triển đa dạng và vô cùng phúc tạp, đăc biệt ḷ à khó khăn với những người mới bắt đầu. Bởi thế, với nhiều cấp đô c̣ủa CSS thì viêc ṭìm hiểu, có thể nắm bắt để sử dụng càng trở nên khó khăn hơn.
-Định dạng của web có khả năng gặp rủi ro
CSS là hê tḥống dựa trên văn bản mở nên viêc truy cập kḥá dễ dàng. Điều này khiến định dạng toàn bô c̣ ủa web hoàn toàn có thể chịu tổn thương, găp gị	án đoạn khi có hành đông, hoặc tai ṇạn nào xảy ra với têp. Ḷúc này nó sẽ yêu cầu truy câp đ̣ọc hoăc ghi ṿào web dự định để có thể ghi đè lên được các thay đổi.
2.2.3. Ngôn ngữ JavaScript

Hình 2.3 Ngôn ngữ JavaScript
Javascript là một ngôn ngữ lập trình kịch bản dựa vào đối tượng phát triển có sẵn hoặc tự định nghĩa ra, javascript được sử dụng rộng rãi trong các ứng dụng Website.
Javascript được hỗ trợ hầu như trên tất cả các trình duyệt như Firefox, Chrome, v.v. thậm chí các trình duyệt trên thiết bị di động cũng có hỗ trợ.
Javascript dùng để tạo ra các trang web có tính tương tác. Các slideshow, pop-up quảng cáo và tính năng autocomplete của Google là những thứ được viết bằng JS.
Lý do Javascript được sử dụng rộng rãi:
-	JavaScript là ngôn ngữ kịch bản phía máy khách (client-side) duy nhất. Do đó, nó được sử dụng trên hầu hết các trang web.
-	Javascript được sử dụng trong công việc phát triển trên web.
-	JavaScript chạy trong một trình duyệt, mà không cần phải tải một phần mềm nào đó về để sử dụng nó. Tất cả bạn cần chỉ là một trình soạn thảo văn bản (như TextWrangler hay TextEdit) và một trình duyệt web.
Javascript có thể làm được những gì?
-	Được dùng để xây dựng toàn bộ một trang web nếu sử dụng với Node.js và MongoDB (một cơ sở dữ liệu).
-	Chịu trách nhiệm về các hiệu ứng động như các cửa sổ pop-up và với AJAX, những trang web có thể hiển thị dữ liệu mới mà không cần phải refresh lại trang.
2.2.4.Mô hình MVC
2.2.4.1.Khái niệm
MVC là viết tắt của Model - View - Controller. Là một mô hình thiết kế phần mềm thường được sử dụng để thiết kế phần mềm có giao diện người dùng. MVC tuy là một mô hình thiết kế phần mềm nhưng nó cũng được sử dụng rộng rãi trong web, sự khác biệt được tùy chỉnh liên quan đến sự có mặt của server – client.
2.2.4.2.Thành phần của mô hình MVC
Mô hình MVC gồm 3 thành phần chính là:
-	Model
Là một dạng mẫu dữ liệu, có nhiệm vụ thao tác với cơ sở dữ liệu, nghĩa là nó sẽ chứa tất cả các hàm, các phương thức truy vấn trực tiếp với dữ liệu và controller sẽ thông qua các hàm, phương thức đó để lấy dữ liệu rồi gửi qua View.
-	View
Là các giao diện người dùng, có nhiệm vụ tiếp nhận dữ liệu từ controller là nơi chứa những giao diện như một nút bấm, khung nhập, menu, hình ảnh… nó đảm nhiệm nhiệm vụ hiển thị dữ liệu và giúp người dùng tương tác với hệ thống.
-	Controller
Là các hành vi, hành động, xử lý của hệ thống đóng vai trò trung gian giữa Model và View. Nó có nhiệm vụ tiếp nhận yêu cầu từ client sau đó xử lý request, load model tương ứng và gửi data qua view tương ứng rồi trả kết quả về cho client.
2.2.4.3.Sự tương tác giữa các thành phần
•	Controller tương tác với qua lại với View
•	Controller tương tác qua lại với Model
•	Model và View không có sự tương tác với nhau mà nó tương tác với nhau thông qua Controller.
2.2.4.4.Luồng xử lý trong mô hình MVC
Khi một yêu cầu của từ máy khách (Client) gửi đến Server. Thì bị Controller trong MVC chặn lại để xem đó là URL request hay sự kiện. Sau đó, Controller xử lý input của user rồi giao tiếp với Model trong MVC. Model chuẩn bị data và gửi lại cho Controller. Cuối cùng, khi xử lý xong yêu cầu thì Controller gửi dữ liệu trở lại View và hiển thị cho người dùng trên trình duyệt. Ở đây, View không giao tiếp trực tiếp với Model. Sự tương tác giữa View và Model sẽ chỉ được xử lý bởi Controller.

Hình 2.4 Sơ đồ mô hình MVC
2.2.4.5. Vì sao nên sử dụng mô hình MVC
	-Quy trình phát triển nhanh hơn
MVC hỗ trợ phát việc phát triển nhanh chóng và song song. Nếu một mô hình MVC được dùng để phát triển bất kỳ ứng dụng web cụ thể nào, một lập trình viên có thể làm việc trên View và một developer khác có thể làm việc với Controller để tạo logic nghiệp vụ cho ứng dụng web đó. Do đó, ứng dụng mô hình MVC có thể được hoàn thành nhanh hơn ba lần so với các ứng dụng mô hình khác.
-Khả năng cung cấp nhiều chế độ view
Trong mô hình MVC, bạn có thể tạo nhiều View cho chỉ một mô hình. Ngày nay, nhu cầu có thêm nhiều cách mới để truy cập ứng dụng và đang ngày càng tăng. Do đó, việc sử dụng MVC để phát triển chắc chắn là một giải pháp tuyệt vời. Hơn nữa, với phương pháp này, việc nhân bản code rất hạn chế. Vì nó tách biệt dữ liệu và logic nghiệp vụ khỏi màn hình.
-Các sửa đổi không ảnh hưởng đến toàn bộ màn hình
Đối với bất kỳ ứng dụng web nào, người dùng có xu hướng thay đổi thường xuyên. Bạn có thể quan sát thông qua những thay đổi thường xuyên về màu sắc, font chữ, bố cục màn hình. Hay là thêm hỗ trợ thiết bị mới cho điện thoại hay máy tính bảng… Việc thêm một kiểu view mới trong MVC rất đơn giản. Vì phần Model không phụ thuộc vào phần View. Do đó, bất kỳ thay đổi nào trong Model sẽ không ảnh hưởng đến toàn bộ kiến trúc.
-MVC Model trả về dữ liệu mà không cần định dạng
MVC pattern có thể trả về dữ liệu mà không cần áp dụng bất kỳ định dạng nào. Do đó, các thành phần giống nhau có thể được sử dụng với bất kỳ giao diện nào. Ví dụ: tất cả loại dữ liệu đều có thể được định dạng bằng HTML. Ngoài ra, nó cũng có thể được định dạng bằng Macromedia Flash hay Dream Viewer.
-Nền tảng MVC thân thiện với SEO
Nền tảng MVC hỗ trợ phát triển các trang web thân thiện với SEO. Bằng nền tảng này, bạn có thể dễ dàng phát triển các URL thân thiện với SEO để tạo ra nhiều lượt truy cập hơn.
2.2.5. Công nghệ ReactJs (Frontend)
2.2.5.1.Khái niệm và vai trò
ReactJS là một thư viện JavaScript để xây dựng/hiển thị giao diện người dùng (UI) cho web (và cả native). Thay vì viết UI theo kiểu “một trang lớn” React khuyến khích chia UI thành các thành phần nhỏ (components) sau đó kết hợp chúng thành giao diện hoàn chỉnh.
Khi phát triển UI bằng React, quy trình tư duy thường được tiếp cận theo hướng
•	Phân rã giao diện thành các component.
•	Xác định các trạng thái hiển thị (visual states) của từng component.
•	Kết nối các component theo luồng dữ liệu để UI thay đổi khi dữ liệu thay đổi.

       Hình 2.5. Ngôn ngữ ReactJS
2.2.5.2.Đặc điểm nội bật của React
1.	Lập trình khai báo
React hướng đến cách mô tả “UI nên trông như thế nào” theo từng trạng thái, thay vì thao tác trực tiếp lên từng phần tử giao diện. Khi dữ liệu/ trạng thái thay đổi, React sẽ cập nhật UI tương ứng.
2.	Component hóa và tái sử dụng
UI được ghép từ các component lồng nhau, giúp tăng khả năng tái sử dụng, dễ tổ chức mã nguồn và dễ mở rộng khi hệ thống lớn dần.
3.	Quản lý trạng thái (state) và truyền dữ liệu (props)
React phân biệt rõ:
•	Props: dữ liệu truyền từ component cha xuống component con.
•	State: “bộ nhớ” của component, dùng để lưu các thông tin thay đổi theo tương tác (ví dụ giá trị nhập form, lựa chọn hiện tại…).
2.2.5.3.Ưu điểm khi sử dụng React
Dựa trên cách React tổ chức UI và quản lý trạng thái,có thể rút ra các ưu điểm quan trọng:
Dễ mở rộng và bảo trì nhờ tách UI thành component rõ ràng có thể phát triển và thay đổi từng phần mà không ảnh hưởng toàn bộ hệ thống.
Phù hợp ứng dụng có nhiều tương tác ( form,lọc,chọn,cập nhật theo hành vi người dùng ) vì React thiết kế State như bộ nhớ giúp UI phản hồi theo tương tác một cách nhất quán.
Tối ưu luồng dữ liệu theo hướng dữ liệu đi xuống (props) và có kỹ thuật “lifting state up” để đồng bộ trạng thái giữa các component liên quan.
Hỗ trợ công cụ phát triển (React Developer Tools) để kiểm tra component props – State và phát hiện vấn đề hiệu năng.
2.2.5.4.Hooks trong React
React cung cấp Hooks để component (dạng function) có thể sử dụng các tính năng của React như State,effect,context.Ngoài Hooks có sẵn người phát triển có thể kết hợp để tạo custom hooks.
Nhóm Hook thường dùng
useState:Khai báo và cập nhật state làm UI render lại khi state thay đổi.
useEffect:Đồng bộ component với hệ thống bên ngoài (API,DOM,kết nội)
useContext:Đọc – đăng ký context để nhận dữ liệu từ các component cha ở xa mà không phải truyền props qua nhiều tầng.
useReducer:Quản lý State theo kiểu reducer phù hợp khi logic cập nhật state phức tạp hoặc nhiều nhánh xử lý.
Quy tắc sử dụng Hooks
Hooks chỉ nên được gọi ở cấp cao nhất của component hoặc custom hook không gọi trong điều kiện – vòng lặp – sau return có điều kiện để tránh hành vi không nhất quán.
2.2.6.Công nghệ Node.js (Backend)
2.2.6.1.Khái niệm
Node.js là môi trường chạy JavaScript trên phía máy chủ (runtime) được được thiết kế theo hướng bất đồng bộ (asynchronous) và hướng sự kiện (event-driven) phù hợp để xây dựng các ứng dụng mạng có khả năng mở rộng (scalable network applications).
Điểm quan trọng của Node.js là khả năng xử lý đồng thời nhiều kết nối bằng cơ chế bất đồng bộ khi có yêu cầu đến Node.js kích hoạt hàm xử lý nếu không có việc cần chạy tiếp tiến trình có thể “nhàn rỗi” và chờ sự kiện mới.

                               Hình 2.6. Công nghệ Node.js
2.2.6.2.Cơ chế hoạt động cốt lõi Event Loop và Non-blocking I/O
Node.js vận hành dựa trên Event Loop Event loop giúp Node.js thực hiện I/O không chặn (non-blocking I/O) dù mặc định chỉ chạy một luồng JavaScript các tác vụ I/O (đọc/ghi mạng, file…) thường được chuyển giao cho hệ điều hành xử lý nền khi có kết quả callback/handler tương ứng sẽ được đưa lại vào vòng lặp sự kiện để xử lý tiếp.
Trong Node.js “blocking” xảy ra khi luồng JavaScript phải chờ một thao tác (thường là thao tác ngoài JS) hoàn tất khiến event loop không tiếp tục chạy được. Vì vậy, thiết kế hệ thống Node.js thường ưu tiên I/O bất đồng bộ và tránh các thao tác làm nghẽn event loop.
2.2.6.3.Ưu điểm của Node.js
Phù hợp ứng dụng web/network nhiều I/O  Node.js được thiết kế để xử lý tốt các tác vụ như request/response HTTP, truy vấn dữ liệu, gọi dịch vụ bên ngoài nhờ cơ chế event-driven và non-blocking.
Khả năng xử lý nhiều kết nối đồng thời event loop hỗ trợ phục vụ nhiều client cùng lúc mà không cần “mỗi kết nối một thread” theo kiểu truyền thống.
Hệ sinh thái gói thư viện lớn (npm): npm là trình quản lý gói tiêu chuẩn của Node.js hỗ trợ cài đặt và quản lý thư viện phụ thuộc cho dự án.
Chuẩn hóa cấu trúc dự án theo package Node.js định nghĩa “package” dựa trên package.json giúp tổ chức mã nguồn theo mô-đun và quản lý phụ thuộc rõ ràng.
2.2.6.4.Nhược điểm và thách thức
Một luồng JavaScript mặc định Node.js dùng một JavaScript thread theo mặc định nếu code JS chạy lâu (CPU-intensive) có thể làm nghẽn event loop và ảnh hưởng đến các request khác.
Nguy cơ “block event loop” nếu dùng thao tác đồng bộ nặng hoặc thiết kế không hợp lý event loop bị chặn sẽ làm hệ thống phản hồi chậm. Tài liệu Node.js cũng nhấn mạnh việc cần tránh chặn event loop worker pool để giữ hiệu năng.
Độ phức tạp bất đồng bộ mô hình async đòi hỏi lập trình viên quản lý tốt luồng xử lý và lỗi (error handling) đặc biệt khi có nhiều bước I/O liên tiếp.
2.2.6.5.Vì sao lựa chọn Node.js cho hệ thống backend website
Với một hệ thống web nghiệp vụ (đăng nhập/đăng ký, tra cứu dữ liệu, đặt vé, thanh toán…) phần lớn thao tác là I/O (giao tiếp mạng, đọc/ghi dữ liệu, gọi dịch vụ…). Mô hình event-driven + non-blocking I/O của Node.js phù hợp để xây dựng backend phục vụ nhiều người dùng đồng thời đồng thời dễ tích hợp các gói thư viện thông qua npm.
2.2.7.Công nghệ MongoDB (NoSQL)
2.2.7.1.Khái niệm
MongoDB là hệ quản trị cơ sở dữ liệu theo mô hình document-oriented (dữ liệu được lưu dưới dạng tài liệu – document). MongoDB lưu các bản ghi dưới dạng BSON document và các document được gom nhóm thành collection một database có thể chứa nhiều collection.
Trong MongoDB mỗi document trong collection tiêu chuẩn bắt buộc có trường _id mang tính duy nhất đóng vai trò tương tự “khóa chính” để định danh bản ghi. Nếu khi thêm mới document mà không cung cấp _id driver thường tự sinh giá trị _id (ví dụ ObjectId).

	            Hình 2.6. Công nghệ MongoDB (NoSQL)
2.2.7.2.Mô hình dữ liệu đặc trưng Schema linh hoạt
Document trong MongoDB được biểu diễn bằng các cặp field–value giá trị của một field có thể là kiểu BSON cơ bản hoặc document lồng (embedded document) mảng hoặc mảng document. Nhờ đó MongoDB phù hợp để mô tả dữ liệu có cấu trúc phân cấp, hoặc nhóm thông tin liên quan trong cùng một bản ghi.
MongoDB có mô hình schema linh hoạt (flexible schema) về mặc định,các document trong cùng collection không bắt buộc phải có cùng tập field kiểu dữ liệu. Tuy nhiên khi hệ thống cần ràng buộc dữ liệu chặt chẽ MongoDB hỗ trợ Schema Validation để thiết lập các quy tắc kiểm tra field (kiểu dữ liệu, phạm vi giá trị, điều kiện bắt buộc…) nhằm đảm bảo dữ liệu tuân thủ thiết kế.
2.2.7.3.Các thao tác cơ bản (CRUD)
MongoDB hỗ trợ đầy đủ nhóm thao tác CRUD (Create – Read – Update – Delete) trên document trong collection. Đây là nhóm thao tác cốt lõi để ứng dụng thực hiện thêm mới truy vấn cập nhật và xoá dữ liệu.
2.2.7.4. Index và ràng buộc dữ liệu
MongoDB cung cấp index để tăng hiệu quả truy vấn. Nếu không có index phù hợp hệ thống có thể phải quét toàn bộ document trong collection để trả kết quả. Tuy nhiên index cũng tạo chi phí khi ghi dữ liệu (insert update) vì phải cập nhật cấu trúc index đi kèm.
Để tránh trùng lặp dữ liệu theo yêu cầu nghiệp vụ MongoDB có unique index đảm bảo giá trị (hoặc tổ hợp giá trị) trên các field được đánh index là duy nhất trong collection. Ngoài ra MongoDB mặc định tạo unique index cho field _id.
2.2.7.5. Aggregation Pipeline (phân tích – thống kê dữ liệu)
MongoDB hỗ trợ Aggregation Pipeline dữ liệu sẽ đi qua một chuỗi stage xử lý tuần tự (lọc, nhóm, tính toán, biến đổi…) để tạo ra kết quả tổng hợp. Cơ chế này phù hợp cho các yêu cầu thống kê như doanh thu theo ngày tháng top phim theo lượt đặt tỷ lệ lấp đầy theo suất chiếu
2.2.7.6. Tính nhất quán và giao dịch
MongoDB đảm bảo tính nguyên tử trên một document thao tác cập nhật trên một document là atomic. Đồng thời MongoDB cho phép mô hình hoá quan hệ bằng embedded document mảng để gom dữ liệu liên quan vào cùng document từ đó giảm nhu cầu giao dịch phân tán cho nhiều tình huống thực tế.
Khi bài toán yêu cầu “tất cả hoặc không có gì” trên nhiều document  nhiều collection MongoDB hỗ trợ multi-document (distributed) transactions để đảm bảo tính nguyên tử trong phạm vi giao dịch.
2.2.7.7. Khả năng sẵn sàng cao và mở rộng
MongoDB hỗ trợ replication thông qua replica set nhiều tiến trình instance cùng duy trì một tập dữ liệu giúp tăng tính sẵn sàng dự phòng và hỗ trợ failover tự động trong triển khai thực tế.
Đối với nhu cầu mở rộng theo chiều ngang MongoDB hỗ trợ sharding – phân tán dữ liệu lên nhiều máy chủ (shard) nhằm đáp ứng các hệ thống có dung lượng dữ liệu lớn hoặc thông lượng truy cập cao.
2.2.7.8.Ưu điểm nhược điểm của MongoDB
Ưu điểm:
Mô hình document linh hoạt hỗ trợ embedded document/mảng giúp mô tả dữ liệu tự nhiên theo cấu trúc nghiệp vụ.
CRUD rõ ràng phù hợp cho các hệ thống web API.
Index hỗ trợ truy vấn hiệu quả có unique index để chống trùng lặp theo ràng buộc.
Aggregation Pipeline phục vụ thống kê/báo cáo.
Atomic single-document và hỗ trợ transactions khi cần giao dịch nhiều document.
Replication và Sharding cho sẵn sàng cao và mở rộng.
Nhược điểm  thách thức khi sử dụng MongoDB:
Index cải thiện đọc nhưng tăng chi phí ghi (write overhead) cần cân nhắc chiến lược index phù hợp theo tải.
Schema linh hoạt có thể dẫn đến dữ liệu không đồng nhất nếu không kiểm soát vì vậy trong hệ thống nghiệp vụ nên dùng Schema Validation và hoặc ràng buộc bằng unique index để đảm bảo chất lượng dữ liệu.
Với bài toán cần giao dịch phức tạp trên nhiều collection, nên cân nhắc thiết kế dữ liệu (embedded vs reference) và chỉ dùng transactions khi thực sự cần.
CHƯƠNG 3: PHÂN TÍCH, THIẾT KẾ VÀ TRIỂN KHAI HỆ THỐNG
3.1.Phân tích yêu cầu bài toán
3.1.1.Tổng quan hệ thống
Hệ thống Website quản lý rạp chiếu phim tích hợp thanh toán trực tuyến và AI Chatbot là một ứng dụng web phục vụ đồng thời hai nhóm người dùng chính khách hàng và bộ phận quản trị - vận hành rạp.Mục tiêu của hệ thống là cung cấp nền tảng đặt vé trực tuyến thuận tiện,hỗ trợ quản trị nghiệp vụ tập trung,đồng thời tích hợp các dịch vụ mở rộng như thanh toán online và chatbot nhằm nâng cao trải nghiệm người dùng.
Về tổng thế,hệ thống được triển khai theo mô hình web tách lớp:
Frontend (Client):Giao diện người dùng chịu trách nhiệm hiển thị nội dung trang chủ,xử lý luồng đăng nhập đăng ký và tương tác API.
Backend (Server/API):Xử lý nghiệp vụ xác thực người dùng cung cấp dữ liệu phim/lịch chiếu thực thi các quy tắc nghiệp vụ và tích hợp các dịch vụ ngoài ( thanh toán,chatbot)
Cơ sở dữ liệu:Lưu trữ người dùng nội dung phim lịch chiếu và các dữ liệu vận hành của hệ thống.
Hệ thống được chia thành các phân hệ chức năng để thuận tiện phân tích – thiết kế - kiểm thử.Trong phạm vi hiện tại báo cáo ưu tiên trình bày phân hệ Trang chủ - Đăng nhập – Đăng ký trước vì đây là điểm vào của hệ thống và là nền tảng để người dùng thực hiện các chức năng quan trong như đặt vé,thanh toán và quản lý vé ở các phân hệ tiếp theo.
Ngoài ra hệ thống có các tương tác bên ngoài có ảnh hưởng trực tiếp đến thiết kế và vận hành:
Cổng thanh toán (VNPay):phục vụ thanh toán đơn hàng yêu cầu xử lý luồng kết quả và đảm bảo tránh ghi nhận trùng giao dịch.
Dịch vụ AI Chatbot:phục vụ hỏi đáp tra cứu thông tin yêu cầu cơ chế kết nối API và kiểm soát nội dung trả lời.
Email/thông báo:dùng cho các hoạt động xác thực,thông báo kết quả hoặc gửi thông tin cho người dùng
3.1.2.Tổng hợp yêu cầu chức năng và phi chức năng
Phần này mô tả các yêu cầu của hệ thống dưới dạng các nhóm chức năng và yêu cầu phi chức năng để đảm bảo tính đầy đủ, rõ ràng và có thể đối chiếu khi thiết kế UML cũng như khi kiểm thử.
Nhóm yêu cầu theo đối tượng sử dụng
Nhóm chức năng dành cho khách hàng
•	Truy cập trang chủ để tra cứu nội dung banner,phim đang chiếu/sắp chiếu,nội dung khuyến mãi/sự kiện.
•	Xác thực tài khoản:đăng nhập/đăng ký để sử dụng các tính năng yêu cầu định danh.
•	Điều hướng nhanh đến quy trình đặt vé mua vé từ trang chủ.
Nhóm chức năng dành cho quản trị/vận hành
•	Quản lý nội dung hiển thị (banner,bài viết/sự kiện) và dữ liệu hệ thống (phim,rạp,phòng,suất chiếu)
•	Theo dõi dữ liệu vận hành (đơn hàng,vé,người dùng…)
Nhóm chức năng mở rộng
•	Thanh toán trực tuyến
•	AI Chatbot hỗ trợ tra cứu hỏi đáp
Phân rã theo hệ thống để trình bày trong chương 3
Để báo cáo mạch lạc và dễ đối chiếu,hệ thống được phân rã thành các phân hệ.Mỗi phần hệ sẽ được trình bày theo cùng một khuôn:mục tiêu – tác nhân – yêu cầu chức năng (FR) – yêu cầu phi chức năng (NFR) – quy tắc nghiệp vụ - use case.
Trong phạm vi hiện tại báo cáo tập trung trước vào:
Phân hệ 1:Trang chủ - Đăng nhập – Đăng ký
Mục tiêu phân hệ
Trang chủ đóng vai trò cung cấp thông tin và điều hướng thao tác đặt vé.
Đăng nhập/đăng ký cung cấp cơ chế xác thực nền tảng cho các chức năng liên quan tài khoản.
Tác nhân:Khách (Guest) Người dùng (User).
Yêu cầu chức năng (FR):trình bày theo các nhóm:FR-HP-01 (HomePage),FR-LG-01 (Login),FR-RG-01 (Register).
Yêu cầu phi chức năng (NFR):trình bày theo các kiểu chỉ tiêu như hiệu năng,bảo mật,responsive,khả dụng.
Quy tắc nghiệp vụ -rút gọn để phục vụ thiết kế & test:
Email tài khoản là duy nhất không cho phép đăng ký trùng.
Dữ liệu đầu vào phải được kiểm tra hợp lệ trước khi gọi API.
Đăng nhập thành công trả về token/phiên,lưu token để duy trì trạng thái.
Khi đăng nhập/đăng ký thất bại hệ thống hiển thị thông báo lỗi và không thay đổi trạng thái phiên
Use case rút gọn ( để khớp phần 3.2 vẽ UML)
UC-01:Xem trang chủ
UC-02:Đăng nhập
UC-03:Đăng ký
3.1.3.Yêu cầu đặt ra
Mục này tổng hợp các yêu cầu và tiêu tích mà hệ thống cần đáp ứng để đảm bảo tính ứng dụng thực tế khả năng mở rộng và phù hợp với triển khai web hiện đại.Nội dung nên viết theo hướng đo được – kiểm chứng được – gắn với luồng nghiệp vụ.
Yêu cầu về tính đúng đắn nghiệp vụ
•	Thông tin hiển thị trên trang chủ phải nhất quán với dữ liệu hệ thống (phim đang chiếu/sắp chiếu, banner, sự kiện…).
•	Đăng nhập/đăng ký phải đảm bảo kiểm tra dữ liệu đầu vào và xử lý lỗi rõ ràng để tránh tạo tài khoản sai hoặc gây nhầm lẫn cho người dùng.
Yêu cầu về hiệu năng và trải nghiệm
•	Trang chủ phải tải nhanh và ổn định, tránh giật/đơ khi dữ liệu danh sách phim tăng.
•	Các thao tác đăng nhập/đăng ký cần phản hồi rõ ràng (loading/success/error), tránh trạng thái “đứng” gây khó hiểu.
Yêu cầu về bảo mật
•	Không lưu mật khẩu dạng rõ dữ liệu nhạy cảm không hiển thị trong log.
•	Phiên đăng nhập (token/phiên) phải có cơ chế hết hạn đăng xuất và được lưu trữ hợp lý phía client.
Yêu cầu về khả năng tương thích và vận hành
•	Giao diện tương thích nhiều kích thước màn hình (desktop/mobile)
•	Hệ thống có cơ chế xử lý lỗi khi API không phản hồi hiển thị thông báo/empty state thay vì lỗi trắng trang…
Yêu cầu về tính mở rộng cho các phân hệ tiếp theo
•	Cấu trúc phân hệ Trang chủ – Đăng nhập – Đăng ký phải đủ “mở” để mở rộng sang các chức năng quan trọng: đặt vé, thanh toán, vé QR, chatbot và quản trị.
•	Quy ước mã yêu cầu (FR/NFR/UC) được chuẩn hóa ngay từ đầu để sau này dễ truy vết: yêu cầu → sơ đồ UML → test case.
3.1.4.Phân tích yêu cầu phân hệ 1:Trang chủ - Đăng nhập – Đăng ký
3.1.4.1.Mục tiêu và phạm vi phân hệ
Phân hệ Trang chủ – Đăng nhập – Đăng ký là phân hệ nền tảng của website đóng vai trò “điểm vào” cho người dùng trước khi sử dụng các chức năng nâng cao như đặt vé, thanh toán, lịch sử giao dịch và chatbot.
Trang chủ tập trung vào hiển thị nội dung chính (banner, phim đang chiếu/sắp chiếu, ưu đãi) và hỗ trợ điều hướng thao tác đặt vé nhanh. Nội dung giao diện bao gồm các khu vực như Header điều hướng & tài khoản, banner slider, khu vực phim, góc điện ảnh và sự kiện/khuyến mãi.
Phạm vi phân hệ trong giai đoạn này bao gồm:hiển thị trang chủ,xử lý form login / register,validation dữ liệu đầu vào,gọi API xác thực và hiển thị thông báo kết quả.
3.1.4.2.Tác nhân và quyền hạn
Guest (khách vãng lai):xem trang chủ,xem danh sách phim,mở form đăng nhập / đăng ký,gửi thông tin đăng ký / đăng nhập.
User (thành viên):sau khi đăng nhập thành công sẽ có trạng thái xác thực để sử dụng các chức năng dành cho tài khoản (sang các phân hệ tiếp theo).
3.1.4.3.Yêu cầu chức năng (FR)
A.Trang chủ (HomePage)
ID	Yêu cầu	Mô tả 	Ưu tiên
FR-HP-01	Hiển thị Banner quảng cáo	Hiển thị slider banner tự động xoay với các poster phim/sự kiện	Cao
FR-HP-02	Thanh đặt vé nhanh 	Cho phép chọn Phim → Rạp → Ngày → Suất chiếu → Mua vé nhanh	Cao
FR-HP-03	Danh sách phim đang chiếu	Hiển thị grid phim với poster, tên, rating, nút đặt vé/xem trailer	Cao
FR-HP-04	Danh sách phim sắp chiếu	Tab chuyển đổi để xem phim sắp ra mắt	Cao
FR-HP-05	Section Góc điện ảnh	Hiển thị thể loại phim, diễn viên, đạo diễn	Trung bình
FR-HP-06	Section Ưu đãi khuyến mại	Hiển thị các sự kiện/khuyến mãi đang diễn ra	Trung bình
FR-HP-07	Responsive Mobile	Giao diện tương thích với thiết bị di động	Cao
B.Đăng nhập (Login)
ID	Yêu cầu	Mô tả 	Ưu tiên
FR-LG-01	Form đăng nhập	Nhập email và mật khẩu	Cao
FR-LG-02	Validation form	Kiểm tra định dạng email, mật khẩu không rỗng	Cao
FR-LG-03	Xác thực với API	Gọi API /api/v1/auth/login để xác thực	Cao
FR-LG-04	Lưu token	Lưu JWT token vào localStorage sau khi đăng nhập thành công	Cao
FR-LG-05	Đăng nhập Google	Cho phép đăng nhập bằng tài khoản Google OAuth	Trung bình
FR-LG-06	Chuyển sang đăng ký	Link chuyển sang modal đăng ký	Cao
FR-LG-07	Quên mật khẩu	Link chuyển sang modal quên mật khẩu	Trung bình
C.Đăng ký (Register)
ID	Yêu cầu	Mô tả 	Ưu tiên
FR-RG-01	Form đăng ký	Nhập họ tên, email, số điện thoại, mật khẩu, giới tính, ngày sinh	Cao
FR-RG-02	Validation form	Kiểm tra email hợp lệ, SĐT 10 số, mật khẩu ≥ 6 ký tự	Cao
FR-RG-03	Xác nhận mật khẩu	So khớp mật khẩu và xác nhận mật khẩu	Cao
FR-RG-04	Gọi API đăng ký	POST /api/v1/auth/register với thông tin user	Cao
FR-RG-05	Thông báo kết quả	Hiển thị thông báo thành công/thất bại	Cao
FR-RG-06	Chuyển sang đăng ký	Link chuyển sang modal đăng ký	Cao
FR-RG-07	Chuyển sang đăng nhập	Tự động chuyển về modal đăng nhập sau khi đăng ký thành công	Cao
3.1.4.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu	Mô tả
NFR-01	Hiệu năng	Trang chủ load < 3 giây, API response < 500ms
NFR-02	Bảo mật	Mật khẩu được hash bằng bcrypt, sử dụng JWT với thời hạn
NFR-03	Khả dụng	Hệ thống hoạt động 24/7
NFR-04	Responsive	Hỗ trợ màn hình từ 320px đến 1920px
NFR-05	Trình duyệt	Hỗ trợ Chrome, Firefox, Safari, Edge phiên bản mới nhất
3.1.4.5.Quy tắc nghiệp vụ và ràng buộc dữ liệu
Các quy tắc dưới đây giúp hệ thống nhất quán và dễ kiểm thử cho phân hệ 1:
BR-01 (Email duy nhất): Email là định danh chính của tài khoản; không cho phép đăng ký trùng email.
BR-02 (Validation trước khi gọi API): Tất cả input phải hợp lệ trước khi gửi request (đúng định dạng email, mật khẩu không rỗng, SĐT đủ 10 số, mật khẩu ≥ 6 ký tự, mật khẩu xác nhận phải trùng). (Khớp FR-LG-02, FR-RG-02, FR-RG-03).
BR-03 (Token phiên đăng nhập): Đăng nhập thành công trả về JWT token và lưu ở localStorage để duy trì trạng thái đăng nhập. (Khớp FR-LG-04).
BR-04 (Thông báo rõ ràng): Khi API lỗi/đăng nhập thất bại/đăng ký thất bại, hệ thống phải hiển thị thông báo và không cập nhật trạng thái đăng nhập. (Khớp FR-RG-05).
BR-05 (Điều hướng đúng luồng): Đăng ký thành công phải điều hướng người dùng quay lại modal đăng nhập. (Khớp FR-RG-06).
3.1.5. Phân tích yêu cầu phân hệ 2: Phim đang chiếu
3.1.5.1.Mục tiêu và phạm vi
Phân hệ Phim đang chiếu là màn hình danh sách phim, tập trung phục vụ nhu cầu tra cứu phim đang chiếu (và có thể kèm tab/phần “sắp chiếu” nếu hệ thống có), giúp người dùng nhanh chóng xem poster/thông tin cơ bản, xem trailer và điều hướng sang luồng đặt vé (BookingPage/Showtime/SeatSelection tùy thiết kế).
Phạm vi phân hệ trong báo cáo bao gồm:hiển thị danh sách phim,lọc/tab trạng thái,phân trang hoặc tải thêm,xem trailer,mở chi tiết/đặt vé.
3.1.5.2.Tác nhân
•	Guest:xem danh sách phim đang chiếu xem trailer, chuyển sang xem chi tiết/đặt vé (tùy chính sách có bắt đăng nhập ở bước sau).
•	User.thực hiện toàn bộ chức năng như Guest (các chức năng theo tài khoản sẽ thuộc phân hệ sau)
3.1.5.3. Yêu cầu chức năng (FR) – MoviePage
ID	Yêu cầu 	Mô tả 	Ưu tiên
FR-MP-01	Hiển thị danh sách phim đang chiếu	Render danh sách phim dạng grid/card: poster, tên, giới hạn tuổi, thời lượng, điểm đánh giá…	Cao
FR-MP-02	Tab/Lọc trạng thái phim	Cho phép chuyển giữa “Đang chiếu / Sắp chiếu” (nếu có), hoặc lọc theo status (NOW/COMING).	Cao
FR-MP-03	Điều hướng xem chi tiết phim	Click vào phim để đi tới trang chi tiết (MovieDetail/BookingPage tùy thiết kế).	Cao
FR-MP-04	Xem trailer	Mở trailer (modal/popup hoặc chuyển trang) từ card phim.	Trung bình
FR-MP-05	Phân trang / tải thêm	Hỗ trợ pagination hoặc “load more” khi số lượng phim lớn.	Trung bình
FR-MP-06	Hiển thị trạng thái tải dữ liệu	Có loading/skeleton khi gọi API, tránh trắng trang.	Cao
FR-MP-07	Xử lý trạng thái rỗng/lỗi	Nếu không có phim hoặc API lỗi → hiển thị empty/error rõ ràng.	Cao
FR-MP-08	Điều hướng sang đặt vé	Từ MoviePage, người dùng có thể bấm “Đặt vé” để sang BookingPage theo movieId.	Cao
3.1.5.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-MP-01	Hiệu năng	Danh sách phim tải ổn định, phản hồi thao tác chuyển tab/lọc mượt.
NFR-MP-02	Khả dụng	Có loading/empty/error; hệ thống vẫn giữ layout ổn định khi lỗi API.
NFR-MP-03	Responsive	Hiển thị tốt trên mobile/desktop (grid co giãn).
NFR-MP-04	Tương thích trình duyệt	Hoạt động tốt trên Chrome/Edge/Firefox bản mới.
NFR-MP-05	Bảo mật luồng điều hướng	Không lộ dữ liệu nhạy cảm; request chỉ lấy dữ liệu công khai của phim.
3.1.5.5.Quy tắc nghiệp vụ
•	BR-MP-01: Danh sách đang chiếu chỉ lấy phim có status = NOW (hoặc điều kiện tương đương theo schema).
•	BR-MP-02: Khi chuyển tab/lọc, danh sách phải cập nhật theo đúng tiêu chí và không hiển thị lẫn trạng thái.
•	BR-MP-03: Khi người dùng chọn “Đặt vé”, hệ thống điều hướng sang BookingPage kèm movieId.
•	BR-MP-04: Trailer chỉ hiển thị/mở được khi phim có trailerUrl hợp lệ.
3.1.6.Phân tích yêu cầu phân hệ 3:Đặt vé xem phim
3.1.6.1.Mục tiêu và phạm vi
Phân hệ đặt vé hỗ trợ khách hàng xem chi tiết phim (poster,mô tả,thời lượng,rating,thể loại,đạo diễn,diễn viên) xem trailer,xem lịch chiếu theo ngày,lọc theo khu vực (thành phố) và rạp,sau đó chọn suất chiếu để chuyển sang bước chọn ghế.Đồng thời hệ thống cho phép đánh giá phim theo thang 1 – 10.
3.1.6.2.Tác nhân Actors
Khách hàng:thực hiện các thao tác xem thông tin phim,xem trailer,xem/lọc,lịch chiếu và chọn suất chiếu để đặt vé.
User:thực hiện thêm thao tác đánh giá phim (tương tác qua modal và gọi API đánh giá)
3.1.6.3.Yêu cầu chức năng (FR) – Booking Page
Mã	Yêu cầu	Mô tả
FR-BK-01	Xem thông tin phim	Xem chi tiết:poster,tên,thời lượng,rating,thể loại,đạo diễn,diễn viên
FR-BK-02	Chọn ngày chiếu	Chọn từ danh sách 7 ngày tới
FR-BK-03	Lọc theo khu vực	Lọc rạp theo thành phố
FR-BK-04	Lọc theo rạp	Chọn rạp củ thể
FR-BK-05	Xem lịch chiếu	Hiển thị suất chiếu theo rạp,format (2D/3D)
FR-BK-06	Chọn suất chiếu	Chọn giờ chiếu để đặt vé
FR-BK-07	Đánh giá phim	Đánh giá phim theo thang 1 – 10
FR-BK-08 	Xem trailer	Xem trailer phim trong modal
3.1.6.4.Yêu cầu phi chức năng (NFR)
Mã	Yêu cầu	Mô tả
NFR-BK-01	Hiệu năng	Trang load <3 giây
NFR-BK-02	Reponsive	Hiển thị tốt trên mobile và desktop
NFR-BK-03	Bảo mật	JWT token vowis auto -refresh
NFR-BK-04	Khả dụng	Fallback “chưa cập nhật”khi thiếu dữ liệu
3.1.6.5.Quy tắc nghiệp vụ
•	BR-BK-01 (Movie tồn tại):Nếu không tìm thấy phim theo movieId thì hệ thống hiển thị trang 404 Movie Not Found và kết thúc luồng.
•	BR-BK-02 (Lịch chiếu theo bộ lọc):Sau khi người dùng chọn ngày,hệ thống tải lại showtimes theo ngày nếu không có suất chiếu thì hiển thị trạng thái “không có suất chiếu”.
•	BR-BK-03 (Điều hướng chọn ghế):Khi người dùng chọn giờ chiếu,hệ thống điều hướng sang /chon-ghe/{showtimeId} để chọn ghế.
•	BR-BK-04 (Fallback dữ liệu):Khi thiếu dữ liệu,hệ thống hiển thị fallback “chưa cập nhật” để đảm bảo trải nghiệm và tránh lỗi giao diện.
3.1.7.Phân tích yêu cầu phân hệ 4: Luồng đặt vé chi tiết
3.1.7.1.Tổng quan phân hệ
Phân hệ 4 mô tả luồng đặt vé hoàn chỉnh của website bao gồm chuỗi màn hình liên tiếp:Đặt vé – chọn ghế – chọn combo – thanh toán –kết quả thanh toán.Luồng này cho phép người dùng đi từ bước chọn suất chiếu,chọn ghế,chọn combo,xác nhận thanh toán và nhận kết ủa sau thanh toán.
3.1.7.2.Tác nhân (Actors)
User (khách hàng):thực hiện toàn bộ thao tác đặt vé từ chọn ghế đến thanh toán và xem kết quả.
VNPay Gateway:hệ thống thanh toán bên thứ ba tiếp nhận thanh toán và phản hồi kết quả về hệ thống.
Backend System:tiếp nhận request từ frontend xử lý nghiệp vụ tạo đơn/giữ ghế/tạo vé/cập nhật trạng thái thanh toán và truy xuất dữ liệu.
3.1.7.3.Yêu cầu chức năng (FR)
A.SeatSelectionPage – Chọn ghế
ID	Yêu cầu	Mô tả 	Ưu tiên
FR-SS-01	Hiển thị sơ đồ ghế	Render sơ đồ phòng chiếu với trạng thái ghế (trống/đã đặt/đang giữ)	Cao
FR-SS-02	Chọn/bỏ chọn ghế	Click để toggle trạng thái chọn ghế	Cao
FR-SS-03	Giữ ghế tạm thời 	Gọi API hold seat khi chọn release khi bỏ	Cao
FR-SS-04	Đếm ngược 15 phút	Timer hiển thị thời gian còn lại để hoàn tất	Cao
FR-SS-05	Tính giá theo loại ghế	Standard/VIP/Couple  có giá khác nhau	Cao
FR-SS-06	Điều hướng liên tục	Chuyển sang ComboPage sau khi chọn ghế	Cao
B.Chọn Combo (ComboPage)
ID	Yêu cầu	Mô tả 	Ưu tiên
FR-CB-01	Hiển thị danh sách Combo	Lấy API /combos	Cao
FR-CB-02	Tăng/giảm số lượng	Nút +/- thay đổi quantity	Cao
FR-CB-03	Tính tổng tiền Combo 	Cập nhật realtime khi thay đổi	Cao
FR-CB-04	Modal xác nhận tuổi	Kiểm tra với phim có giới hạn tuổi	Cao
FR-CB-05	Điều hướng thanh toán	Chuyển sang PaymentConfirmPage	Cao
C.Thanh toán (PaymentConfirmPage)
ID	Yêu cầu	Mô tả 	Ưu tiên
FR-PM-01	Hiển thị thông tin đơn hàng 	Phim,ghế,combo,tổng tiền	Cao
FR-PM-02	Nhập/chọn voucher	Áp dụng mã giảm giá	Cao
FR-PM-03	Tính toán giảm giá 	Trừ discount vào tổng tiền	Cao
FR-PM-04	Chọn phương thức thanh toán 	VNPay	Cao
FR-PM-05a	Tạo đơn hàng 	Gọi API POST/orders	Cao
FR-PM-05b	Xác nhận thông tin trước thanh toán	Modal hiển thị tóm tắt đơn hàng checkbox đồng ý điều khoản	Trung bình
FR-PM-06	Redirect VNPay	Chuyển sang cổng thanh toán	Cao
D.Kết quả thanh toán (PaymentResultPage)
ID	Yêu cầu	Mô tả 	Ưu tiên
FR-PR-01	Hiển thị trạng thái	Thành công/thất bại với icon	Cao
FR-PR-02	Thông tin đơn hàng 	Lấy API theo orderNo	Cao
FR-PR-03	Chi tiết vé	Phim,rạp,ghế,suất chiếu	Cao
FR-PR-04	Nút điều hướng	Về trang chủ hoặc thử lại	Cao
3.1.7.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-01	Hiệu năng	API response < 500ms,trang load < 3s
NFR-02	Realtime	Cập nhật trạng thái ghế theo thời gian thực
NFR-03	Bảo mật	JWT authentication,HTTPS
NFR-04	Responsive	Tương thích mobile/desktop
NFR-05	Tính nhất quán	Giá tính ở frontend = backend
3.1.7.5.Quy tắc nghiệp vụ
Các quy tắc nghiệp vụ trọng tâm trong luồng đặt vé:
BR-01:Ghế chỉ được giữ tối đa 15 phút,hết hạn thì từ động release.
BR-02:Mỗi user chỉ được dùng một voucher code 1 lần.
BR-03:Giá ghế VIP = basePrice + 5000đ.
BR-04:Giá ghế Couple = (basePrice +10000đ) x 2.
BR-05.Thanh toán thất bại  Order status =FAILED.
3.1.8.Phân tích yêu cầu phân hệ 5:Thể loại phim
3.1.8.1.Mục tiêu và phạm vi phân hệ
Phân hệ thể loại phim là trang hiển thị danh sách các bài viết về điện ảnh được phân loại theo thể loại phim,quốc gia sản xuất và năm phát hành.Trang này đóng vai trò như một góc điện ảnh giúp người dùng khám phá thông tin về các thể loại,diễn viên,đạo diễn và các nội dung liên quan đến điện ảnh.
Phạm vi phân hệ bao gồm:
•	Hiển thị danh sách bài viết thể loại theo dạng grid/card
•	Bộ lọc đa tiêu chí:thể loại,quốc gia,năm,trạng thái,sắp xếp
•	Phân trang với số trang điều hướng
•	Tương tác thích bài viết
•	Điều hướng sang trang chi tiết bài viết
•	Sidebar hiển thị phim đang chiếu
3.1.8.2.Tác nhân và quyền hạn
Tác nhân	Quyền hạn
Guest (khách)	Xem danh sách bài viết,lọc theo tiêu chí,xem chi tiết bài viết,phân trang
User (thành viên)	Tất cả quyền của Guest + thích/bỏ bài viết
3.1.8.3.Yêu cầu chức năng (FR) GenresPage
ID	Yêu cầu	Mô tả	Ưu tiên
FR-GN-01	Hiển thị danh sách bài viết	Render danh sách bài dạng card:poster,tiêu đề,mô tả ngắn,lượt xem,lượt thích	Cao
FR-GN-02	Lọc theo thể loại	Dropdown chọn thể loại phim (hành động,kinh dị,tình cảm)	Cao
FR-GN-03	Lọc theo quốc gia	Dropdown chọn quốc gia sản xuất (Hàn quốc,Việt Nam,Mỹ)	Cao
FR-GN-04	Lọc theo năm 	Dropdown chọn năm phát hành	  Trung bình
FR-GN-05	Lọc theo trạng thái	Lọc phim đang chiếu/sắp chiếu	Trung bình
FR-GN-06	Sắp xếp danh sách	Lọc sắp xếp theo danh sách xem nhiều nhất,mới nhất,thích nhiều nhất	Cao
FR-GN-07	Phân trang 	Hiển thị default 15 bài viết/trang với navigation số trang	Cao
FR-GN-08	Thích bài viết	User có thể thích hoặc bỏ thích bài viết và cập nhật số lượt thích	Cao
FR-GN-09	Điều hướng chi tiết	Click vào bài viết hoặc poster để xem chi tiết bài viết	Cao
FR-GN-10	Sidebar phim đang chiếu	Hiển thị danh sách phim đang chiếu ở sidebar	  Trung bình
FR-GN-11	Bộ lọc mobile	Drawer bộ lọc cho thiết bị di động 	Cao
FR-GN-12	Đặt lại bộ lọc	Nút reset cho bất cả bộ lọc trở về mặc định	   Trung bình
3.1.8.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-GN-01	Hiệu năng	Trang load < 3 giây,API response < 500ms
NFR-GN-02	Responsive	Hỗ trợ desktop và mobile và Drawer filter
NFR-GN-03	URL State	Bộ lọc được lưu trong URL params để chia sẻ và bookmark
NFR-GN-04	Loading State	Hiển thị loading spinner khi tải dữ liệu
NFR-GN-05	Tương thích	Hoạt động tốt trên Chrome,Firefox,Safari,Edge
3.1.8.5.Quy tắc nghiệp vụ
•	BR-GN-01:Khi thay đổi bộ lọc,danh dách phải cập nhật reset về trang 1
•	BR-GN-02:Chỉ user đã đăng nhập mới được kích hoạt bài viết,Guest sẽ nhận thông báo yêu cầu đăng nhập
•	BR-GN-03:Trạng thái thích được lưu trên server và hiển thị đúng khi user truy cập lại
•	BR-GN-04:URL params phải đồng bộ với trạng thái lọc hiện tại
•	BR-GN-05:Phân trang hiển thị tối đa 5 số trang + dấu nếu có nhiều trang
3.1.9. Phân tích và yêu cầu phân hệ 6:Chi tiết thể loại
3.1.9.1.Mục tiêu và phạm vị phân hệ
Phân hệ chi tiết thể loại phim được hiển thị chi tiết một bài viết về thể loại phim,bao gồm nội dung bài viết,thông tin metadata (thể loại,quốc gia,năm…) thư viện hình ảnh,trailer và khu vực bình luận.Trang này cho phép người dùng đọc nội dung chi tiết,xem trailer,duyệt gallery ảnh và tương tác qua hệ thống bình luận.
Phạm vi phân hệ bao gồm:
•	Hiển thị thông tin chi tiết bài viết (tiêu đề,nội dung,metadata)
•	Thư viện hình ảnh với lightbox xem phóng to
•	Modal xem trailer video
•	Tích hợp component CommentSection cho bình luận
•	Breadcrumb điều hướng
•	Sidebar bài viết liên quan
3.1.9.2.Tác nhân và quyền hạn
Tác nhân	Quyền hành
Guest (khách)	Xem nội dung bài viết,xem gallery,xem trailer
User (thành viên)	Tất cả quyền của Guest + bình luận,đánh giá,tả lời bình luận
3.1.9.3.Yêu cầu chức năng (FR) GenresDetailPage
ID	Yêu cầu	Mô tả	Ưu tiên
FR-GD-01	Hiển thị thông tin bài viết	Hiển thị tiêu đề,nội dung HTML metadata (thể loại,quốc gia,năm,lượt xem)	Cao
FR-GD-02	Thư viện hình ảnh	Grid ảnh với preview,click mở lightbox phóng to	Cao
FR-GD-03	Lightbox gallery	Modal xem ảnh full screen với nút prev/next	Cao
FR-GD-04	Xem trailer	Nút mở modal xem trailer video từ youtube	Cao
FR-GD-05	Breadcrumb	Hiển thị đường dẫn:Trang chủ >thể loại phim > [tên bài viết]	      Cao
FR-GD-06	Bình luận bài viết 	Tích hợp CommentSection cho phép đánh giá bình luận	Trung bình
FR-GD-07	Bài viết liên quan 	Sidebar hiển thị các bài viết cùng thể loại	     Thấp
FR-GD-08	Chia sẻ bài viết	Nút chia sẻ lên mạng xã hội	Cao
FR-GD-09	Loading state	Skeleton loading khi tải dữ liệu	Cao
FR-GD-10	Xử lý lỗi 404	Hiển thị trang 404 nếu không tìm thấy bài viết	    Cao
3.1.9.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-GD-01	Hiệu năng	Trang load < 3 giây,ảnh lazy loading
NFR-GD-02	SEO	Title và meta description động theo bài viết
NFR-GD-03	Responsive	Layout tích ứng desktop/tablet/mobile
NFR-GD-04	Accessibility	Lightbox hỗ trợ keyboard navigation
3.1.9.5.Quy tắc nghiệp vụ
•	BR-GD-01:Khi truy cập bài viết,hệ thống tự động tăng view count
•	BR-GD-02:Nội dung HTML được render an toàn,loại bỏ script độc hại
•	BR-GD-03:Trailer chỉ hiển thị nút xem nếu bài viết có trailerUrl hợp lệ
•	BR-GD-04:CommentSection nhận genreId để load/post bình luận bài viết
3.1.10.Phân tích yêu cầu phân hệ 7:Bình luận
3.1.10.1.Mục tiêu và phạm vi phân hệ
Phân hệ bình luận là component tái sử dụng cho chức năng bình luận và đánh giá được tích hợp trong cả trang chi tiết phim và trang chi tiết thể loại Component này cho phép người dùng đánh giá theo thang sao 1-5,viết bình luận,trả lời bình luận,thích bình luận và báo cáo nội dung vi phạm.
Phạm vi phân hệ bao gồm:
•	Đánh giá theo thang 1-5 sao
•	Viết bình luận với tiêu đề và nội dung
•	Đánh giấu spoiler cho nội dung tiết lộ phim
•	Trả lời (reply) bình luận
•	Thích bày tỏ cảm xúc (reaction) bình luận
•	Báo cáo bình luận vi phạm
•	Ẩn bình luận cục bộ
•	Bộ lọc:đã mua vé,không spoiler,sắp xếp
•	Phân trang bình luận
3.1.10.2.Tác nhân và quyền hạn
Tác nhân	Quyền hạn
Guest (khách)	Xem danh sách bình luận,xem thống kê đánh giá
User (thành viên)	Tất cả quyền Guest + viết bình luận,đánh giá,trả lời,thích,báo cáo,ẩn bình luận
Verified User	User + Badge “Đã mua vé” hiển thị cạnh tên
3.1.10.3.Yêu cầu chức năng (FR)
ID	Yêu cầu	Mô tả	Ưu tiên
FR-CM-01	Hiển thị thống kê đánh giá	Điểm trung bình,tổng số đánh giá,biểu đồ phân bổ sao	Cao
FR-CM-02	Form viết bình luận	Chọn sao,nhập tiêu đề,nội dung,checkbox spoiler	Cao
FR-CM-03	Validation form	Bắt buộc chọn sao,nội dung tối thiểu 20 ký tự	Cao
FR-CM-04	Danh sách bình luận 	Hiển thị avatar,tên,thời gian,rating,nội dung	Cao
FR-CM-05	Ẩn nội dung spoiler	Blur nội dung spoiler,nút hiện spoiler để xem	Cao
FR-CM-06	Trả lời bình luận 	Form reply inline,hiển thị replies dạng nested	Cao
FR-CM-07	Thích bình luận 	Nút thích với emoji reactions (like,love,haha)	Cao
FR-CM-08	Báo cáo bình luận	Dialog chọn lý do báo cáo vi phạm	Trung bình
FR-CM-09	Ẩn bình luận cục bộ	Ẩn bình luận chỉ cho User hiện tại,lưu localStorage	Trung bình
FR-CM-10	Bộ lọc bình luận 	Lọc:đã mua vé,không spoiler,ẩn tất cả spoiler	Cao
FR-CM-11	Sắp xếp bình luận 	Mới nhất,cũ nhất,thích nhiều nhất	Cao
FR-CM-12	Phân trang	10 bình luận/trang với navigation số	Cao
FR-CM-13	Badge Verified	Hiển thị Badge đã mua vé cho User đã mua vé	Trung bình
3.1.10.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-CM-01	Hiệu năng	Load comments < 500ms,submit < 1 giây
NFR-CM-02	Realtime feel	Cập nhật UI ngay sau action
NFR-CM-03	Persistence	Bình luận ẩn cục bộ persist qua reload
NFR-CM-04	Responsive	Form và list hiển thị tốt trên mobile
NFR-CM-05	Accessibility	Form có label rõ ràng,keyboard navigation
3.1.10.5.Quy tắc nghiệp vụ
•	BR-CM-01:Chỉ User đăng nhập mới được viết bình luận,Guest click sẽ hiện modal đăng nhập.
•	BR-CM-02:Mỗi User chỉ được đánh giá 1 lần cho mỗi phim/bài viết tránh việc spam
•	BR-CM-03:Nội dung bình luận tối thiểu 20 ký tự,reply tối thiểu 10 ký tự.
•	BR-CM-04:Bình luận có hasSpoiler=true sẽ bị blur yêu cầu và click để hiện.
•	BR-CM-05:User bị ban (chatBanUntil > now) không thể viết bình luận,hiển thị thống báo thời gian hết ban.
•	BR-CM-06:Báo cáo bình luận sẽ gửi đến Admin để xử lý,mỗi user chỉ report 1 lần/bình luận.
•	BR-CM-07:Bình luận ẩn cục bộ lưu vào LocalStorage với key theo movieId/genreId.
3.1.11.Phân tích yêu cầu phân hệ 8:Danh sách diễn viên
3.1.11.1.Mục tiêu và phạm vị phân hệ
Phân hệ danh sách diễn viên là trang hiện thị danh sách các diễn viên trong hệ thống,đóng vai trò như một cổng thông tin giúp người dùng tra cứu diễn viên theo quốc tịch,sắp xếp theo nhiều tiêu chí và tương tác thông qua chức năng thích diễn viên.
Phạm vi phân hệ bao gồm:
•	Hiện thị danh sách diễn viên theo dạng card với avatar,tên,tiểu sử ngắn,lượt xem và thích.
•	Bộ lọc quốc tịch.
•	Sắp xếp danh sách theo:phổ biến nhất,mới nhất,thích nhiều nhất.
•	Tương tác thích/bỏ thích diễn viên cập nhật lạc quan.
•	Điều hướng sang trang chi tiết diễn viên.
•	Sidebar hiện thị danh sách phim đang chiếu.
•	Bộ lọc mobile dạng Drawer cho thiết bị di động.
3.1.11.2.Tác nhân và quyền hạn
Tác nhân	Quyền hạn
Guest (khách)	Xem danh sách diễn viên,lọc theo quốc tịch,sắp xếp,phân trang,xem chi tiết diễn viên
User (thành viên)	Tất cả quyền của Guest + thích/bỏ thích diễn viên
3.1.11.3.Phân tích yêu cầu chức năng (FR)
ID	Yêu cầu	Mô tả	Ưu tiên
FR-AC-01	Hiện thị danh sách diễn viên	Render danh sách diễn viên dạng card:avatar,tên,tiểu sử ngắn,lượt xem,lượt thích	Cao
FR-AC-02	Lọc theo quốc tịch	Dropdown chọn quốc tịch	Cao
FR-AC-03	Sắp xếp danh sách	Sắp xếp theo:phổ biến nhất,mới nhất,được thích nhất	Cao
FR-AC-04	Phân trang	Hiện thị 10 diễn viên/trang với navigation số trang,cuộn lên đầu khi chuyển trang	Cao
FR-AC-05	Thích diễn viên 	User có thể thích hoặc bỏ diễn viên,cập nhật số lượt thích,realtime	Cao
FR-AC-06	Hiện thị lượt xem 	Hiện thị số lượt xem của mỗi diễn viên	Cao
FR-AC-07	Điều hướng chi tiết	Click vào diễn viên hoặc avatar để xem trang chi tiết diễn viên (/dien-vien-chi-tiet/:slug)	Cao
FR-AC-08	Sidebar phim đang chiếu	Hiện thị danh sách phim đang chiếu ở sidebar với poster,tên,rating	Trung bình
FR-AC-09	Bộ lọc mobile	Drawer bộ lọc cho thiết bị di động với nút mở/đóng	Cao
FR-AC-10	Đặt lại bộ lọc 	Nút reset đưa tất cả dữ liệu về trạng thái ban đầu 	Trung bình
FR-AC-11	URL State Sync	Bộ lọc và trang hiện tại được lưu trong URL params được chia sẻ và bookmark	Trung bình
FR-AC-12	Loading State	Hiện thị loading spinner toàn màn hình khi tải dữ liệu	Cao
3.1.11.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-AC-01	Hiệu năng	Trang load < 3 giây,API response < 500ms,gọi song song nhiều API bằng Promise.all
NFR-AC-02	Responsive	Hỗ trợ desktop và mobile,layout thích ứng với breakpoint,Drawer filter trên mobile
NFR-AC-03	URL State	Bộ lọc được lư trong URL params (?quoc-tich=…&sap-xep=…&page=…) để chia sẻ và bookmark
NFR-AC-04	UX Optimistic	Cập nhật UI ngay khi thích/bỏ thích,rollback nếu API lỗi
NFR-AC-05	Tương thích	Hoạt động tốt trên Chrome,Firefox,Safari,Edge phiên bản mới nhất
NFR-AC-06	Khả dụng	Có fallback khi API lỗi (hiện thị danh sách rỗng) không crash ứng dụng
3.1.11.5.Quy tắc nghiệp vụ
•	BR-AC-01:Khi đang gọi API like cho một diễn viên,nút like của diễn viên đó bị vô hiệu hóa  để tránh gọi trùng.
•	BR-AC-02:Khi thích/bỏ thích UI cập nhật ngay lập tức trước khi API trả về.Số lượt thích được tính dựa trên trạng thái trước đó và không được xuống dưới 0.
•	BR-AC-03:Nếu API thích/bỏ thích trả lỗi,hệ thống rollback UI về trạng thái trước đó (cả số likeCount và trạng thái liked trong localStorage).
•	BR-AC-04:Sau khi API thành công,số likeCount được sync với giá trị từ server để đảm bảo nhất quán dữ liệu.
•	BR-AC-05:Trạng thái đã thích/chưa thích được lưu vào localStorage với key `actor _liked_{actorId}` để persist qua các lần truy cập.
•	BR-AC-06:Khi thay đổi quốc tịch hoặc cách sắp xếp,trang tự động reset về trang 1.
•	BR-AC-07:Khi click vào diễn viên,hệ thống tự điều hướng đến `/dien-vien-chi-tiet/:slug` với slug của diễn viên.
•	BR-AC-08:Danh sách quốc tích được tải từ API `/api/v1/persons/nationalities` thay vì hardcode,đảm bảo dữ liệu luôn cập nhật theo database.
3.1.12.Phân tích yêu cầu phân hệ 9:Chi tiết diễn viên
3.1.12.1.Mục tiêu và phạm vi phân hệ
Phân hệ chi tiết diễn viên là trang hiện thị thông tin chi tiết của một diễn viên,bao gồm thông tin cá nhân,tiểu sử đầy đủ,thư viện hình ảnh và danh sách phim đã tham gia.Trang này cho phép người dùng khám phá sâu hơn về diễn viên yêu thích,xem gallery ảnh với chế độ slideshow tự động và các tương tác thông qua chức năng thích.
Phạm vi phân hệ bao gồm:
•	Hiển thị thông tin cá nhân diễn viên (tên,ảnh đại diện,ngày sinh,chiều cao,quốc tịch,nơi sinh,nghề nghiệp).
•	Hiển thị tiểu sử ngắn và tiểu sử đầy đủ.
•	Thư viện hình ảnh với chế độ xem phóng to và tự động chuyển ảnh.
•	Danh sách phim đã tham gia với điều hướng đến chi tiết phim.
•	Tăng lượt xem với cơ chế cooldown 24 giờ.
•	Thích/bỏ diễn viên với optimistic update và rollback.
•	Sidebar hiện thị phim đang chiếu.
•	Breadcrumb điều hướng.
•	Fallback chưa cập nhật khi thiếu dữ liệu
3.1.12.2.Tác nhân và quyền hạn
Tác nhân	Quyền hạn
Guest (khách)	Xem thông tin diễn viên,xem gallery ảnh,xem filmography,xem tiểu sử,xem sidebar phim đang chiếu
User (thành viên)	Tất  cả quyền của Guest + thích/bỏ thích diễn viên
3.1.12.3.Yêu cầu chức năng (FR)
ID	Yêu cầu	Mô tả	Ưu tiên
FR-AD-01	Hiện thị thông tin cá nhân 	Hiện thị ảnh đại diện,tên,ngày sinh,chiều cao,quốc tịch,nơi sinh,nghề nghiệp	Cao
FR-AD-02	Hiện thị tiểu sử ngắn 	Hiện thị shortBio dạng italic,line clamp 4 dòng trên mobile 	Cao
FR-AD-03	Hiện thị tiểu sử đầy đủ	Section Tiểu sử với nội dung fullBio/biography đẩy đủ 	Cao
FR-AD-04	Thư viện hình ảnh	Gird ảnh với preview,click mở Dialog xem phóng to	Cao
FR-AD-05	Gallery Lightbox	Dialog xem ảnh full screen với nút prev/next,đóng băng nút X	Cao
FR-AD-06	Gallery Autoplay	Tự động chuyển đổi ảnh mỗi 3 giây,có nút Play/Pause để điều khiển 	Trung bình
FR-AD-07	Hiện thị Filmography	Section PHIM ĐÃ THAM GIA với danh sách phim:poster,tên phim,vai diễn	Cao
FR-AD-08	Điều hướng đến phim	Click vào phim trong filmography chuyển đến /phim/:slug	Cao
FR-AD-09	Thích diễn viên	Nút like với số lượt thích,cập nhật realtime	Cao
FR-AD-10	Hiện thị lượt xem	Badge hiện thị viewCount của diễn viên	Trung bình
FR-AD-11	Tăng lượt xem	Tự động tăng viewCount khi truy cập,có cooldown 24 tiếng	Cao
FR-AD-12	Breadcrumb	Hiện thị đường dẫn:Trang chủ > diễn viên > tên diễn viên	Cao
FR-AD-13	Sidebar phim đang chiếu	Hiện thị phim đang chiếu ở sidebar với poster,tên,rating	Cao
FR-AD-14	Loading State 	Hiện thị loading spinner toàn màn hình khi tải dữ liệu 	Cao
FR-AD-15	Xử lý 404 	Hiện thị thông báo không tìm thấy diễn viên với nút quay lại danh sách	Cao
3.1.11..Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-AD-01	Hiệu năng	Trang load < 3 giây,API response < 500ms
NFR-AD-02	Responsive	Layout thích ứng desktop/mobile/tablet,ảnh scoll ngang trên mobile
NFR-AD-03	UX Optimistic	Cập nhật UI ngay khi thích/bỏ thích,rollback nếu API lỗi
NFR-AD-04	Khả dụng	Có fallback chưa cập nhật khi thiếu dữ liệu,không crash ứng dụng
NFR-AD-05	Tương thích	Hoạt động tốt trên Chrome,Firefox,Safari,Edge phiên bản mới nhất
NFR-AD-06	Accessibility	Gallery hỗ trợ điều hướng bằng nút,Breadcrumb có semantic rõ ràng
3.1.12.5.Quy tắc nghiệp vụ
•	BR-AD-01:Lượt xem của một diễn viên chỉ được tăng 1 lần mỗi 24 tiếng cho mỗi trình duyệt.Thời gian truy cập cuối được lưu trong localStorage với key `actor_view_{actorId}`.Nếu thời gian hiện tại trừ thời gian lưu nhỏ hơn 24 tiếng (86,400,000ms) hệ thống không gọi API tăng view .
•	BR-AD-02:Sử dụng useRef để đánh giấu đã tăng view trong sesstion hiện tại (`viewIncrementedRef`) tránh gọi API trùng lặp khi component re-render.
•	BR-AD-03:Khi thích/bỏ thích UI cập nhật ngay lập tức (isLiked,likeCount,localStorage) trước khi API trả về.Số likeCount không được xuống dưới 0.
•	BR-AD-04:Nếu API toogle like trả về lỗi,hệ thống rollback về trạng thái trước đó bao gồm:isLiked state,likeCount trong actor state và giá trị trong localStorage.
•	BR-AD-05:Sau khi API thành công likeCount đươc sync với giá trị từ server (`res.data.likeCount`) để đảm bảo nhất quán.
•	BR-AD-06:Khi các trường nhất quán không có giá trị (biography,filmography,photos) hệ thống hiện thị text chưa cập nhật thay vì đề trống hoặc lỗi giao diện.
•	BR-AD-07:Gallery chỉ hiện thị khi `actor.photos` tồn tại và có độ dài > 0.Autoplay chỉ hoạt động khi chỉ có nhiều hơn một ảnh.
•	BR-AD-08:Hệ thống tải diễn viên theo slug từ URL params.Nếu tìm không thấy (actorData = null) hiện thị màn hình 404 với nút quay lại.
3.1.13. Phân tích yêu cầu phân hệ 10:Danh sách đạo diễn
3.1.13.1.Mục tiêu và phạm vi phân hệ
Phân hệ danh sách đạo diễn là trang hiện thị danh sách các đạo diễn trong hệ thống,đóng vai trò như một cổng thông tin giúp người tra cứu đạo diễn theo quốc gia,sắp xếp theo nhiều tiêu chí và tương tác thông qua chức năng thích đạo diễn.Trang này là một phần quan trọng trong mục “góc điện ảnh” của website cung cấp trải nghiệm khám phá thông tin về các đạo diễn nổi tiếng trong ngành điển ảnh.
Phạm vị phân hệ bao gồm:
•	Hiện thị danh sách đạo diễn theo card với avatar,tên,tiểu sử ngắn,lượt xem và lượt thích.
•	Bộ lọc quốc tịch động lấy từ API backend.
•	Sắp xếp danh sách theo:phổ biến nhất,mới nhất,được thích nhất.
•	Tương tác thích/bỏ thích đạo diễn với cập nhật lạc quan.
•	Điều hướng sang trang chi tiết đạo diễn..
•	Sidebar hiện thị danh sách phim đang chiếu.
•	Bộ lọc mobile dạng Drawer cho thiết bị di động.
•	Đồng bộ trang thái bộ lọc với URL params để hỗ trợ chia sẻ và bookmark.
3.1.13.2.Tác nhân và quyền hạn
Tác nhân	Quyền hạn
Guest (khách)	Xem danh sách đạo diễn,lọc theo quốc tịch,sắp xếp,phân trang,xem chi tiết đạo diễn,xem sidebar phim đang chiếu
User (thành viên)	Tất cả quyền của Guest + thích/bỏ thích đạo diễn

3.1.13.3.Yêu cầu chức năng (FR)
ID	Yêu cầu	Mô tả	Ưu tiên
FR-DR-01	Hiện thị danh sách đạo diễn  	Render danh sách đạo diễn dạng card:avatar,tên,tiểu sử ngắn,lượt xem,thích	Cao
FR-DR-02	Lọc theo quốc tịch 	Dropdown theo quốc tịch,dữ liệu từ API `/api/v1/persons/nationalities?role=director` 	Cao
FR-DR-03	Sắp xếp danh sách 	Sắp xếp theo 3 tiêu chí:phổ biến,mới nhất,được thích nhất	Cao
FR-DR-04	Phân trang 	Hiện thị 10 đạo diễn/trang với navigation số trang,cuộn lên đầu khi chuyển trang	Cao
FR-DR-05	Thích đạo diễn	User có thể thích hoặc bỏ thích đạo diễn,cập nhật số lượt thích realtime 	Cao
FR-DR-06	Hiện thị lượt xem	Hiện thị số lượt xem của mỗi đạo diễn badge	Trung bình
FR-DR-07	Điều hướng chi tiết 	Click vào tên đạo diễn hoặc avatar để xem trang chi tiết đạo diễn (`/dao-dien-chi-tiet/:slug`)	Cao
FR-DR-08	Sidebar phim đang chiếu	Hiện thị danh sách phim đang chiếu ở sidebar với poster,tên,rating	Trung bình
FR-DR-09	Bộ lọc mobile 	Drawer bộ lọc cho thiết bị di động với nút mở/đóng 	Cao
FR-DR-10	Đặt lại bộ lọc 	Nút reset đặt tất cả bộ lọc về trạng thái ban đầu mặc định (quốc gia:tất cả,sắp xếp:phổ biến nhất	Trung bình
FR-DR-11	URL State Sync	Bộ lọc và trang hiện tại được lưu trong URL params (`?quoc-tich=&sap-xep&page=`) để chia sẻ bookmark	Cao
FR-DR-12	Loading State	Hiện thị loading spinner toàn màn hình khi tải lại dữ liệu	Cao
3.1.13.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-DR-01	Hiệu năng	Trang load < 3 giây,API response < 500ms,gọi song song với nhiều API bằng Promise.all
NFR-DR-02	Responsive	Hỗ trợ desktop và mobile,layout thích ứng vơi breakpoint,Drawer filter trên mobile
NFR-DR-03	URL State 	Bộ lọc lưu trong URL params (`?quoc-tich=…&sap=xep=…&page…`) để chia sẻ và bookmark
NFR-DR-04	UX Optimistic	Cập nhật UI ngay khi thích/bỏ thích,rollback nếu API lỗi
NFR-DR-05	Tương thích	Hoạt động tốt trên Chrome,Firefox,Safari,Edge phiên bản mới nhất
NFR-DR-06	Khả dụng 	Có fallback khi API lỗi ( hiện thị danh sách rỗng) không bị carsh ứng dụng
3.1.13.5.Quy tắc nghiệp vụ
•	BR-DR-01:Khi đang gọi API like cho một đạo diễn,nút like của đạo diễn đó bị vô hiệu hóa để tránh bị gọi trùng.
•	BR-DR-02:Khi thích/bỏ thích UI cập nhật ngay lập tức trước khi API trả về.Số lượt thích được tính dựa trên trạng thái trước đó và không được xuống dưới 0.
•	BR-DR-03:Nếu API thích/bỏ thích trả lỗi thì hệ thống rollback UI về trạng thái trước đó (cả số likeCount và trạng thái liked trong localStorage)
•	BR-DR-04:Sau khi API thành công,số likeCount được sync với giá trị từ server để đảm bảo nhất quán giá trị.
•	BR-DR-05:Trạng thái đã thích/chưa được thích được lưu vào localStorage với key `director_liked_{directorId` để persist qua các lần truy cập.
•	BR-DR-06:Khi thay đổi quốc tịch hoặc cách sắp xếp,trang tự động reset về trang 1.
•	BR-DR-07:Khi click vào đạo diễn,hệ thống điều hướng đến `dao-dien-chi-tiet/:slug` với slug của đạo diễn.
•	BR-DR-08:Danh sách quốc tích được tải từ API `api/v1/persons/nationalities?role=director` thay vì hardcode,đảm bảo dữ liệu luôn cập nhật theo database và chỉ lấy quốc tịch của đạo diễn (không lần diễn viên).
3.1.14.Phân tích yêu cầu phân hệ 11:Chi tiết đạo diễn
3.1.14.1.Mục tiêu và phạm vi phân hệ
Phân hệ chi tiết đạo diễn là trang hiện thị thông tin chi tiết của một đạo diễn,bao gồm thông tin cá nhân,tiểu sử đầy đủ,thư viện hình ảnh và danh sách phim đã đạo diễn.Trang này cho phép người dùng khám phá sâu hơn về đạo diễn yêu thích,xem gallery ảnh với chế độ slideshow tự động và tương tác thông qua chức năng thích.
Phạm vi phân hệ bao gồm:
•	Hiện thị thông tin cá nhân đạo diễn (tên,ảnh đại diễn,ngày sinh,chiều cao,quốc tịch,nơi sinh,nghề nghiệp).
•	Hiện thị tiểu sử ngắn với tiểu sử đầy đủ.
•	Thư viện hình ảnh với chế độ xem phóng to và tự động chuyển ảnh.
•	Danh sách phim đạo diễn đã tham gia với điều hướng đến trang chi tiết phim.
•	Tăng lượt xem với cơ chế cooldown 24 tiếng.
•	Thích bỏ/thích đạo diễn với optimistic update và rollback.
•	Sidebar hiện thị phim đang chiếu.
•	Breadcrumb điều hướng.
•	Fallback Placeholder “Đang cập nhập khi” khi thiếu dữ liệu.
3.1.14.2.Tác nhân và quyền hạn
Tác nhân	Quyền hạn
Guest (khách)	Xem thông tin chi tiết đạo diễn,xem gallery ảnh,xem những phim mà đạo diễn đã tham gia,xem tiểu sử,xem sidebar phim đang chiếu
User (thành viên)	Tất cả quyền của Guest + thích/bỏ thích đạo diễn
3.1.14.3.Yêu cầu chức năng (FR)
ID	Yêu cầu	Mô tả	Ưu tiên
FR-DD-01	Hiện thị thông tin cá nhân  	Hiện thị ảnh đại diện,tên,ngày sinh,chiều cao,quốc tích,nơi sinh,nghề nghiệp	Cao
FR-DD-02	Hiện thị tiểu sử ngắn 	Hiện thị shortBio dạng italic,line clamp 4 dòng trên mobile 	Cao
FR-DD-03	Hiện thị tiểu sử đầy đủ	Section tiểu sử nội dung với fullBio/biography đầy đủ	Cao
FR-DD-04	Thư viện ảnh 	Gird ảnh với preview,click mở Dialog xem phóng to	Cao
FR-DD-05	Gallery Lightbox 	Dialog xem ảnh full screen với nút prev/next,đóng nút X 	Cao
FR-DD-06	Gallery Autoplay	Tự động chuyển ảnh mỗi 3 giây,có nút Play/Pause để điều khiển	Trung bình
FR-DD-07	Hiện thị Filmography	Section “Phim đã tham gia” với danh sách phim:poster,tên phim,vai trò 	Cao
FR-DD-08	Điều hướng đến phim 	Click vào phim trong filmography chuyển đến `/phim/:slug`	Cao
FR-DD-09	Thích đạo diễn	Nút like với số lượt thích,cập nhật realtime 	Cao
FR-DD-10	Hiện thị lượt xem 	Badge hiện thị viewCount của đạo diễn	Cao
FR-DD-11	Tăng lượt xem 	Tự động tăng viewCount khi truy cập có cooldown 24 tiếng	Cao
FR-DD-12	Beardcrumb	Hiện thị đường dẫn:Trang chủ > đạo diễn > [tên đạo diễn]	Cao
FR-DD-13	Sidebar phim đang chiếu	Hiện thị phim đang chiếu ở sidebar với poster,tên,rating	Cao
FR-DD-14	Loading State	Hiện thị loading spinner toàn màn hình khi tải lại dữ liệu 	Cao
FR-DD-15	Xử lý 404	Hiện thị thông báo “không tìm thấy diễn viên”  và nút quay lại danh sách,khi không có dữ liệu	Cao
3.1.14.4.Yêu cầu phi chức năng (NFR)
ID	Yêu cầu 	Mô tả
NFR-DD-01	Hiệu năng	Trang load < 3 giây,API response < 500ms,gọi song song với nhiều API bằng Promise.all
NFR-DD-02	Responsive	Layout tương thích desktop/mobile/tablet ảnh srcoll ngang trên mobile
NFR-DD-03	UX Optimistic 	Cập nhật UI ngay khi thích/bỏ và tawng view,rollback nếu API lỗi
NFR-DD-04	Khả dụng 	Có fallback “Đang cập nhật” khi dữ liệu,không carsh ứng dụng
NFR-DD-05	Tương thích	Hoạt động tốt trên Chrome,Firefox,Safari,Edge phiên bản mới nhất
NFR-DD-06	Accessibility 	Gallery hỗ trợ điều hướng nút,Breadcrumb có semantic rõ ràng
3.1.14.5.Quy tắc và nghiệp vụ
•	BR-DD-01:Lượt xem của một đạo diễn chỉ được tăng 1 lần mỗi 24 tiếng cho mỗi trình duyệt.Thời gian truy cập cuối được lưu trong localStorage vơi key `director_view_{directorId}`.Nếu thời gian hiện tại trừ thời gian lưu nhỏ hơn 24 tiếng (86,400,000ms)hệ thống không gọi API để tăng view.
•	BR-DD-02:Sử dụng useRef để đánh dấu đã tăng view trong session hiện tại (`viewIncrementedRef`) tránh gọi API trùng lặp khi component re-render hoặc trong React StrictMode.
•	BR-DD-03:Khi thích/bỏ thích UI cập nhật ngay lập tức (isLiked,likeCount,localStorage) trước khi API trả về.Số likeCount không được xuống dưới 0.
•	BR-DD-04:Nếu API toggle like trả về lỗi hệ thống rollback về trạng thái trước đó bao gồm:isLiked state,likeCount trong director state và giá trị trong localStorage.
•	BR-DD-05:Sau khi API thành công likeCount được sync với giá trị từ server (`res.data.likeCount`)để đảm bảo nhất quán.
•	BR-DD-06:Khi các trường thông tin không có giá trị (biography,filmography,photos)hệ thống hiện thị placeholder text với dòng “Đang cập nhật” thay vì để trống hoặc gây lỗi giao diện.
•	BR-DD-07:Gallery hiện thị khi `director.photos` tồn tại và có độ dài > 0.Autoplay chỉ hoạt động khi có nhiều hơn 1 ảnh.
•	BR-DD-08:Hệ thống tải đạo diễn theo slug từ URL params.Nếu không tìm thấy (directorData = null) hoặc role không phải ‘director’/‘both’ hiện thị màn hình 404 với nút quay lại.
3.2.Thiết kế hệ thống
3.2.1.Kiến trúc tổng thể phân hệ 1:Trang chủ - Đăng nhập – Đăng ký
Phân hệ Trang chủ - Đăng nhập – Đăng ký được thiết kế theo mô hình kiến trúc web tách lớp nhằm phân tách rõ trách nhiệm hiển thị,xử lý nghiệp vụ và lưu trữ dữ liệu.Hệ thống áp dụng cấu trúc 3 lớp gồm:Presentation layer (React),Application layer (Express/Node.js) và Database layer (MongoDB)
Mô hình kiến trúc và thành phần
•	Presentation layer – Frontend (ReactJS): chịu trách nhiệm hiển thị giao diện Trang chủ (banner, danh sách phim, sự kiện) và các form Đăng nhập/Đăng ký; thực hiện kiểm tra dữ liệu đầu vào (validation) trước khi gửi yêu cầu; lưu trạng thái phiên phía client (JWT token) để duy trì đăng nhập.
•	Application layer – Backend API (Node.js/Express): cung cấp REST API, xử lý nghiệp vụ xác thực (đăng nhập/đăng ký), kiểm tra ràng buộc (ví dụ email duy nhất), tạo và trả JWT token; đồng thời cung cấp API cho dữ liệu Trang chủ (phim, banner, sự kiện). Theo mô hình MERN, Express và Node.js đóng vai trò “tầng giữa” đảm nhiệm logic phía server.
•	Database layer – MongoDB (Collections): lưu trữ dữ liệu của phân hệ gồm các collection như Users, Movies, Banners, Events. MongoDB cung cấp chức năng lưu trữ và truy xuất dữ liệu; mô hình tài liệu cho phép linh hoạt khi dữ liệu thay đổi/tiến hóa theo thời gian.


Hình 3.1 – Kiến trúc tổng thể phân hệ Trang chủ – Đăng nhập – Đăng ký
Luồng giao tiếp và định dạng dữ liệu
Phân hệ vận hành theo cơ chế Frontend – Backend qua HTTPS REST API.Frontend gửi request (kèm dữ liệu form tham số truy vấn),Backend xử lý và trả về JSON response cho Frontend hiển thị.Backend thực hiện truy vấn MongoDB (Query/CRUD) để lấy dữ liệu trang chủ hoặc tạo / cập nhật người dùng khi đăng ký.
Mở rộng tích hợp dịch vụ ngoài
Trong thiết kế tổng thể Backend được tổ chức theo hướng có thể tích hợp các dịch vụ bên ngoài qua HTTPS để phục vụ các phân hệ tiếp theo
•	VNPay (Payment Gateway): phục vụ thanh toán đơn hàng, có luồng request và callback/return.
•	Gemini API (AI Chatbot): phục vụ hỏi đáp/tư vấn tự động.
3.2.2.Use Case Diagram Trang chủ - Đăng nhập – Đăng ký

Hình 3.2.Sơ đồ Use Case Diagram – Phân hệ Trang chủ/Đăng nhập/Đăng ký
3.2.3. Activity Diagram
Activity Diagram – Đăng nhập

Hình 3.3. Sơ đồ Activity – Đăng nhập
Activity Diagram – Đăng ký

Hình 3.4 Sơ đồ Activity – Đăng ký
3.2.4. Sequence Diagram
Sequence Diagram – Đăng nhập

Hình 3.5. Sơ đồ Sequence (tương tác hệ thống) – Đăng ký
Sequence Diagram – Đăng ký

Hình 3.6. Sơ đồ Sequence (tương tác hệ thống) – Đăng ký
3.2.5.Class Diagram rút gọn (Auth/home) – Phân hệ 1
3.2.5.1.Mục đích
Class Diagram mô tả cấu trúc tĩnh của phân hệ 1 bao gồm lớp,thuộc tính,phương thức và quan hệ phụ thuộc giữa chúng.Sơ đồ này này giúp làm rõ cách hệ thống được tổ chức theo tầng.
(Controller/Service/Repository/Entity) đồng thời là cơ sở để đối chiếu với các sơ đồ hành vi như Activity Diagram và Sequence Diagram trong các mục trước.
3.2.5.2.Phạm vi
Phạm vị Class Diagram rút gọn tập trung vào 2 nhóm chức năng:
Authentication:Đăng nhập – Đăng ký (AuthController,AuthService,JwtService,
UserRepository,User)
Home:Lấy dữ liệu từ trang chủ (HomeController, HomeService,MovieRepository/
BannerRepository/EventRepository và các Entity tương ứng
3.2.5.3. Các lớp chính
Controller layer
•	AuthController: nhận request /auth/login, /auth/register, trả response.
•	HomeController: cung cấp API lấy dữ liệu trang chủ (banner/phim/sự kiện).
Service layer
•	AuthService: xử lý nghiệp vụ đăng nhập/đăng ký (kiểm tra email tồn tại, so khớp mật khẩu hash, tạo JWT)
•	HomeService: tổng hợp dữ liệu hiển thị trang chủ theo yêu cầu UI
Repository layer
•	UserRepository:truy xuất/ghi dữ liệu người dùng
•	MovieRepositor,BannerRepository,EventRepository:truy xuất dữ liệu nội dung trang chủ.
Entity/Model
•	User, Movie, Banner, Event: biểu diễn cấu trúc dữ liệu lưu trữ MongoDB phục vụ phân hệ 1

Hình 3.7.Sơ đồ Class Diagram rút gọn – Phân hệ Home & Authentication
3.2.6.Thiết kế hệ thống phân hệ 2 – Phim đang chiếu
3.2.6.1.Kiến trúc hệ thống
Phân hệ phim đang chiếu áp dụng kiến trúc web tách lớp:
•	Frontend (React): MoviePage.jsx chịu trách nhiệm render danh sách, xử lý tab/lọc, mở trailer modal và điều hướng đặt vé.
•	Backend (Node.js/Express): cung cấp API lấy danh sách phim theo trạng thái (NOW/COMING), trả dữ liệu chuẩn hóa cho client.
•	Database (MongoDB): lưu collection movies (và các collection tham chiếu như genres/persons nếu có).

Hình 3.8. Kiến trúc tổng thể phân hệ phim đang chiếu
3.2.7.Use Case Diagram – Phim đang chiếu

Hình 3.9. Use Case Diagram Phim đang chiếu
3.2.8. Activity Diagram – Xem phim đang chiếu

Hình 3.10. Activity Diagram luồng xử lý phim đang chiếu (xem phim đang chiếu)
3.2.9. Sequence Diagram – Tải danh sách phim

Hình 3.11. Sequence Diagram tải danh sách phim
3.2.10. Class Diagram – Phim đang chiếu
Nội dung mô tả
Class Diagram rút gọn phân hệ phim đang chiếu mô tả cấu trúc các lớp và mối quan hệ giữa chúng trong chức năng hiển thị danh sách phim đang chiếu và phim sắp chiếu.Diagram được chia thành hai lớp kiến trúc chính:Frontend Layer (React Component và API Client) và Backend Layer (Express Controllers và Mongoose Models)


Hình 3.12. Class Diagram rút gọn phân hệ phim đang chiếu
3.2.11.Thiết kế hệ thống đặt vé
3.2.11.1.Kiến trúc tổng thể phân hệ đặt vé
Phân hệ đặt vé áp dụng kiến trúc web tách lớp:
•	Frontend:
Gồm BookingPage.jsx và các module gọi API như movieApi.js – cinemaApi.js – showtimeApi.js sử dụng Axios + Interceptors để tự động đính kèm token và hỗ trợ cơ chế refresh token khi cần.
•	Backend:
Xây dựng bằng Node.js/Express tổ chức theo các controller như MovieController – ShowtimeController – CinemaController xử lý các REST requests và truy cập dữ liệu qua Mongoose ODM.
•	Database:
Sử dụng MongoDB lưu các collection liên quan gồm:movies,showtimes,cinemas,persons…

Hình 3.13 – Sơ đồ kiến trúc tổng thể phân hệ đặt vé
3.2.12.Use Case Diagram – Đặt vé

Hình 3.14. Sơ đồ Use Case của phân hệ đặt vé
3.2.13. Activity Diagram – Đặt vé

Hình 3.15. Sơ đồ Activity mô tả luồng đặt vé .
3.2.14. Sequence Diagram (tương tác hệ thống) – Đánh giá phim

Hình 3.16: Sơ đồ Sequence mô tả tương tác đánh giá phim trên BookingPage
3.2.15. Class Diagram rút gọn – Đặt vé
Nội dung mô tả
Class Diagram rút gọn của đặt vé mô tả cấu trúc tĩnh của các thực thể cốt lõi phục vụ tra cứu lịch chiếu và điều hướng đặt vé.Ba lớp trung tâm gồn Movie,Showtime và Cinema.Trong đó Movie lưu thông tin phim để hiển thị trên trang đặt vé,Showtime biểu diễn một suất chiếu củ thể (thời gian chiếu,định dạng,phòng chiếu…),Cinema lưu thông tin rạp (tên rạp,địa chỉ/khu vực) để hỗ trợ lọc theo khu vực/rạp.
Về quan hệ,hệ thống tổ chức theo mô hình 1-N:một Movie có thể có nhiều Showtime (Showtime tham chiếu movieId) và một Cinema có thể có nhiều Showtime (Showtime tham chiếu cinemaId).Khi người dùng thao tác trên BookingPage,frontend gọi API để lấy Movie details,danh sách Cinema/Cities và danh sách Showtime theo bộ lọc (ngày/khu vực/rạp).Dữ liệu trả về được nhóm theo rạp và hiển thị theo khung giờ khi người dùng chọn một suất chiếu hệ thống điều hướng sang màn hình chọn ghế và mang theo showtimeId.

Hình 3.17. Sơ đồ Class Diagram rút gọn của phân hệ đặt vé
3.2.16.Thiết kế hệ thống – Chọn ghế
3.2.16.1.Kiến trúc tổng thể chọn ghế
Chọn ghế được triển khai theo mô hình web tách lớp trong đó frontend chịu trách nhiệm hiển thị sơ đồ ghế,xử lý thao tác chọn/bỏ chọn ghế và đếm ngược thời gian ghế,backend cung cấp các API để lấy dữ liệu suất chiếu kiểm tra trạng thái ghế và thực hiện nghiệp vụ giữ ghế/hủy giữ ghế,MongoDB lưu dữ liệu suất chiếu phòng chiếu và trạng thái giữ ghế theo thời gian hết hạn.

Hình 3.18.Sơ đồ kiến trúc tổng thể chọn ghế
3.2.16.2.Use Case Diagram – Chọn ghế

Hình 3.19. Sơ đồ Use Case Diagram – Chọn ghế
3.2.16.3.Activity Diagram – Luồng chọn ghế

Hình 3.20.Sơ đồ Activity Diagram luồng chọn ghế
3.2.16.4.Sequence Diagram – Giữ ghế

Hình 3.21.Sơ đồ Sequence Diagram Giữ ghế
3.2.16.5.Class Diagram rút gọn – Chọn ghế
Class Diagram rút gọn mô tả các lớp chính phục vụ chọn ghế gồm:lớp giao diện SeatSelectionPage quản lý showtimeId,dữ liệu ghế,danh sách ghế đã chọn và thời gian đếm ngược,lớp Showtime cung cấp thông tin suất chiếu ,lớp Room cung cấp sơ đồ ghế và lớp SeatHold đại diện cho bản ghi giữ ghế theo thời hạn.Mối quan hệ giữa các lớp thể hiện việc SeatHold tham chiếu Showtime/Room theo định danh đồng bộ trạng thái ghế khi người dùng thao tác.

Hình 3.22.Sơ đồ Class Diagram rút gọn – SeatSelectionPage
3.2.17.Thiết kế hệ thống – Chọn combo
3.2.17.1.Use case Diagram – Chọn combo

Hình 3.23.Sơ đồ Use Case Diagram chọn combo
3.2.17.2.Activity Diagram – Luồng chọn combo

Hình 3.24.Sơ đồ Activity Diagram luồng chọn combo
3.2.17.3.Class Diagram rút gọn – Chọn combo
Class Diagram rút gọn của chọn combo tập trung vào lớp giao diện chọn combo quản lý danh sách combo và số lượng người dùng chọn,lớp Combo mô tả dữ liệu combo,đồng thời thể hiện quan hệ phụ thuộc giữa UI và API lấy dữ liệu combo để đảm bảo tổng tiền được tính đồng nhất theo dữ liệu tải về.

Hình 3.25.Sơ đồ Class Diagram rút gọn chọn combo
3.2.18.Thiết kế hệ thống – Xác nhận & thanh toán
3.2.18.1.Use Case Diagram – Xác nhận & thanh toan

Hình 3.26.Sơ đồ Use Case Diagram xác nhận & thanh toán
3.2.18.2.Sequence Diagram – Áp dụng voucher & tạo thanh toán

Hình 3.27. Sơ đồ Sequence Diagram – Áp dụng voucher & thanh toán
3.2.18.3.Class Diagram – Hệ thống Voucher Wallet

Hình 3.28.Sơ đồ Class Diagram – Hệ thống Voucher Wallet
3.2.19.Thiết kế hệ thống – Kết quả thanh toán
3.2.19.1.Activity Diagram – Hiển thị kết quả thanh toán

Hình 3.29. Sơ đồ Activity Diagram kết quả thanh toán
3.2.19.2.Sequence Diagram – Tải đơn và hiển thị kết quả

Hình 3.30.Sơ đồ Sequence Diagram tải đơn và hiện thị kêt quả
3.2.20.Thiết kế hệ thống – Thể loại phim
3.2.20.1.Kiến trúc tổng thể phân hệ thể loại phim
Phân hệ thể loại phim được thiết kế theo mô hình web tách hợp tương tự các phân hệ trước,gồm ba tầng chính:Frontend (ReactJS),Backend API (Node.js/Express) và CSDL (MongoDB).
•	Frontend (ReactJS):GenresPage.jsx chịu trách nhiệm render danh sách bài viết,xử lý bộ lọc,phân trang và tương tác thích bài viết.
•	Backend (Node.js/Express):Cung cấp API lấy danh sách thể loại,bộ lọc động (categories,countries,years) xử lý toggle like.
•	Database (MongoDB):Lưu collection genres,categories và theo dõi trạng thái like

Hình 3.31.Sơ đồ kiến trúc tổng thể phân hệ thể loại phim
3.2.20.2. Use Case Diagram – Thể loại phim

Hình 3.32.Sơ đồ Use case Diagram thể loại phim
3.2.20.3. Activity Diagram – Luồng lọc và xem bài viết

Hình 3.33.Sơ đồ Activity Diagram luồng lọc và xem bài viết
3.2.20.4.Sequence Diagram – Thích bài viết

Hình 3.34.Sơ đồ Sequence thích/bỏ thích bài viết
3.2.20.5. Class Diagram rút gọn – Thể loại phim
Class Diagram rút gọn của thể loại phim tập trung vào hai lớp chính ở frontend là GenresPage và genreApi cùng các lớp backend GenreController,GenreService
GenreRepository và entity Genre.Quan hệ thể hiện theo kiểu tầng trên phụ thuộc tầng dưới:GenresPage sử dụng genreApi,controller sử dung service,service sử dụng
repository, repository thao tác trực tiếp với entity Genre trong MongoDB

Hình 3.35.Sơ đồ Class Diagram rút gọn phân hệ thể loại phim
3.2.21. Thiết kế hệ thống – Chi tiết thể loại
3.2.21.1.Kiến trúc tổng thể phân hệ chi tiết thể loại
Chi tiết thể loại được thiết kế để hiện thị một bài viết củ thể của thể loại:
•	Frontend:GenresDetailPage.jsx render nội dung,gallery,trailer modal và tích hợp CommentSection
•	Backend:API lấy chi tiết genres theo slug,tự động tăng view count
•	Integration:Component CommentSection được tái sử dụng với prop genreId

Hình 3.36.Sơ đồ kiến trúc tổng thể phân hệ chi tiết thể loại
3.2.21.2. Use case Diagram – Chi tiết thể loại

Hình 3.37.Sơ đồ Use case Diagram chi tiết thể loại
3.2.21.3.Activity Diagram – Xem chi tiết bài viết và bình luận

 Hình 3.38.Sơ đồ Activity Diagram luồng xem chi tiết bài viết và bình luận
3.2.21.4. Sequence Diagram – Load chi tiết bài viết

Hình 3.39.Sơ đồ Sequence luồng load chi tiết bài viết
3.2.21.5. Class Diagram rút gọn – Chi tiết thể loại
Class Diagram rút gọn tập trung vào mối quan hệ giữa GenresDetailPage,genreApi,component CommnentSection ở frontend và các lớp backend phục vụ chi tiết bài viết (GenreController,GenreService,GenreRepository,entity Genre,Review)

Hình 3.40.Sơ đồ Class Diagram rút gọn phân hệ chi tiết thể loại
3.2.22.Thiết kế hệ thống – Bình luận
3.2.22.1.Kiến trúc hệ thống phân hệ bình luận
Bình luận là component tái sử dụng được thiết kế theo pattern:
•	Props-based Configuration:Nhận movieId hoặc genreId để xác định target.
•	Dual API Support:Tự động chọn đúng API (movie review hoặc genre review)dựa trên props.
•	Local State Management:Sử dụng React Hooks cho state management
•	LocalStorage Integration:Persist bình luận ẩn cục bộ

Hình 3.41.Sơ đồ kiến trúc tổng thể component bình luận
3.2.22.2. Use Case Diagram – Bình luận

Hình 3.42.Sơ đồ Use case Diagram bình luận
3.2.22.3.Activity Diagram – Viết và gửi bình luận

Hình 3.43.Sơ đồ Activity Diagram viết và gửi bình luận
3.2.22.4.Sequence Diagram – Báo cáo bình luận vi phạm

Hình 3.44.Sơ đồ Sequence báo cáo cho bình luận vi phạm
3.2.22.5.Sequence Diagram - Ẩn bình luận cục bộ

Hình 3.45.Sơ đồ Sequence ẩn bình luận cục bộ
3.2.22.6. Class Diagram rút gọn – Bình luận
Class Diagram rút gọn mô tả cấu trúc các lớp liên quan đến hệ thống bình luận:component CommentSection,sub-component hiện thị reaction,client reviewApi các controller backend và entity Review,ReviewReport.

Hình 3.46.Sơ đồ Class Diagram rút gọn phân hệ bình luận
3.2.23.Thiết kế hệ thống – Danh sách diễn viên
3.2.23.1.Kiến trúc tổng thể phân hệ danh sách diễn viên
Phân hệ danh sách diễn viên được thiết kế theo mô hình kiến trúc web tách lớp,bao gồm 3 tầng chính hoạt động độc lập và giao tiếp thông qua REST API.
Mô hình kiến trúc và thành phần:
Frontend:
•	ActorsPage.jsx:Component chính chịu trách nhiệm render danh sách diễn viên,xử lý bộ lọc quốc tịch,sắp xếp,phân trang và tương tác like.
•	personApi.js:Module API client sử dụng Axios để gọi các endpoint backend.
•	State Management:Sử dụng React hooks (useState,useEffect,useRef) để quản lý trạng thái local.
•	URL State Sync:Đồng bộ bộ lọc và phân trang với URL params thông quan `useSearchParams`
Backend:
•	personController.js:Controller xử lý các request liên quan đến Person.
•	personRouter.js:Định nghĩa các route API.
Database:
•	Collection `persons`:lưu trữ thông tin diễn viên/đạo diễn.
•	Sử dụng Mongoose ODM với các method:`find()`,`countDocuments()`,`distinct()`,`findByIdAndUpdate()`.
•	Index trên các trường:`role`,`isActive`,`nationality`,`viewCount`,`likeCount`

Hình 3.47.Sơ đồ kiến trúc tổng thể phân hệ danh sách diễn viên
3.2.23.2.Use case Diagram – Danh sách diễn viên

Hình 3.48.Sơ đồ Use case Diagram danh sách diễn viên
3.2.23.3.Activity Diagram – Luồng xem và lọc danh sách diễn viên

Hình 3.49.Sơ đồ Activty Digram – Luồng xem và lọc danh sách diễn viên
3.2.23.4.Sequence Diagram – Thích diễn viên

Hình 3.50.Sơ đồ Sequence Diagram – Toogle like diễn viên
3.2.23.5.Class Diagram rút gọn – Danh sách diễn viên
Mục đích:
Mô tả cấu trúc các lớp và mối quan hệ giữa chúng trong phân hệ ActorsPage,bao gồm frontend components,API client và backend layers
Phạm vị:
•	Frontend:ActorsPage component,personApi module
•	Backend:PersonController,PersonService,PersonModel
•	Mối quan hệ:Dependency,Association

Hình 3.51.Sơ đồ Class Diagram rút gọn – Danh sách diễn viên
3.2.24.Thiết kế hệ thống – Chi tiết diễn viên
3.2.24.1.Kiến trúc hệ thống phân hệ chi tiết diễn viên
Phân hệ chi tiết diễn viên được thiết kế theo mô hình kiến trúc web tách lớp,hiện thị thông tin chi tiết của một diễn viên bao gồm thông tin cá nhân,tiểu sử,gallery ảnh,filmography.
Mô hình kiến trúc và thành phần:
Frontend:
•	`ActorDetailPage.jsx`:Component chính hiển thị chi tiết diễn viên
•	`personApi.js`:API client cho các endpoint person
State Management:useState,useEffect,useRef (view cooldown tracking)
Features:Gallery lightbox với autoplay,filmography grid,breadcrumb
Backend:
•	`personController.js`:Controller xử lý các request
Enpoints chính:
•	`GET /api/v1/persons/:slug`:Lấy chi tiết diễn viên theo slug
•	`POST /api/v1/persons/:id/view`:Tăng view count
•	`POST /api/v1/persons/:id/view`:Toggle like/unlike
Database:
•	Collection:`persons`:Lưu trữ thông tin diễn viên
•	Collection:`movies`:Lấy phim đang chiếu cho sidebar

Hình 3.52.Sơ đồ kiến trúc tổng thể phân hệ chi tiết diễn viên
3.2.24.2.Use case Diagram – Chi tiết diễn viên

Hình 3.53.Sơ đồ Use case Diagram chi tiết diễn viên
3.2.24.3.Activity Diagram – Luồng xem chi tiết và tăng view

Hình 3.54.Sơ đồ Activity Diagram luồng xem chi tiết diễn viên
3.2.24.4.Sequence Diagram – Tăng view Count với Cooldown

Hình 3.55.Sơ đồ Sequence Diagram tăng view count với cooldown
3.2.24.5.Class Diagram rút gọn – Chi tiết diễn viên
Mục đích:
Mô tả cấu trúc các lớp và mối quan hệ trong phân hệ ActorDetailPage

Hình 3.56.Sơ đồ Class Diagram rút gọn chi tiết diễn viên
3.2.25.Thiết kế hệ thống – Danh sách đạo diễn
3.2.25.1.Kiến trúc phân hệ danh sách đạo diễn
Phân hệ danh sách đạo diễn được thiết kế theo mô hình kiến trúc web tách lớp bao gồm 3 tầng chính hoạt động độc lập và giao tiếp thông qua REST API.
Mô hình kiến trúc và thành phần:
Frontend:
•	FilmDirectorPage:Component chính chịu trách nhiệm render danh sách đạo diễn,xử lý bộ lọc quốc tịch,sắp xếp,phân trang và tương tác like.
•	personApi:Module API client sử dụng Axios để gọi các endpoint backend
•	State Management:Sử dụng React hooks (useState,useEffect,useRef) để quản lý trạng thái local.
•	URL State Sync:Đồng bộ bộ lọc và phân trang URL params thông qua `useSearchParams`
Backend:
•	`personController`:Controller xử lý các request liên quan đến Person.
•	`personRouter`:Định nghĩa các route API.
Database:
•	Collection `persons`:Lưu trữ thông tin đạo diễn/diễn viên.
•	Sử dụng Mongoose ODM với các       method:`find()`,`countDocuments()`,`distinct()`,`findByIdAndUpdate()`

Hình 3.57.Sơ đồ kiến trúc tổng thể phân hệ danh sách đạo diễn
3.2.25.2.Use case Diagram – Danh sách đạo diễn

Hình 3.58.Sơ đồ Use Case danh sách đạo diễn
3.2.25.3.Activity Diagram – Luồng xem và lọc danh sách đạo diễn

Hình 3.59.Sơ đồ activity diagram luồng xem và lọc danh sách đạo diễn
3.2.25.4.Sequence Diagram – Toggle like đạo diễn

Hình 3.60.Sơ đồ Sequence Diagram toogle like đạo diễn
3.2.25.5.Class Diagram rút gọn – Danh sách đạo diễn
Mục đích:
Mô tả các trúc các lớp và mối quan hệ giữa chúng trong phân hệ danh sách đạo diễn bao gồm:frontend components,API client và backend layers.
Phạm vi:
•	Frontend:FilmDirectorPage component,personApi module,movieApi module.
•	Backend:PersonController,Person Model.
•	Mối quan hệ:Dependency,Association.

Hình 3.61.Sơ đồ Class Diagram rút gọn danh sách đạo diễn
3.2.26.Thiết kế hệ thống – Chi tiết đạo diễn
3.2.26.1.Kiến trúc tổng thể phân hệ chi tiết đạo diễn
Phân hệ chi tiết đạo diễn được thiết kế theo mô hình kiến trúc web tách lớp,hiện thị thông tin chi tiết của một đạo diễn bao gồm thông tin cá nhân,tiểu sử gallery ảnh và filmography.
Mô hình kiến trúc và thành phần:
Frontend:
•	FilmDirectorDetailPage:Component chính hiện thị trang chi tiết đạo diễn.
•	personApi:API client cho các endpoint person
•	State Management:useState,useEffect,useRef (view cooldown tracking)
•	Features:Gallery lightbox với Autoplay,filmography,breadcrumb
Backend:
•	personController:Controller xử lý các request
•	Endpoint chính:
-	GET /api/v1/persons/:slug:Lấy chi tiết đạo diễn theo slug
-	POST /api/v1/persons/:id/view:Tăng view count
-	POST /api/v1/persons/:id/like:Toggle like/unlike
Database:
•	Collection `persons`:Lưu trữ thông tin đạo diễn
•	Collection `movie`:Lấy phim đang chiếu cho sidebar và filmography references

Hình 3.62.Sơ đồ kiến trúc tổng thể phân hệ chi tiết đạo diễn
3.2.26.2.Use Case Diagram – Chi tiết đạo diễn

Hình 3.63.Sơ đồ use case chi tiết đạo diễn
3.2.26.3.Activity Diagram – Luồng xem chi tiết và tăng view

Hình 3.64.Sơ đồ activity diagram luồng xem chi tiết đạo diễn
3.2.26.4.Sequence Diagram viewCount với Cooldown

Hình 3.65.Sơ đồ sequence diagram tăng viex`wCount với Cooldown
3.2.26.5.Class Diagram rút gọn – Chi tiết đạo diễn
Mục đích:
Mô tả cấu trúc các lớp và mối quan hệ trong phân hệ chi tiết đạo diễn
Phạm vi:
•	Frontend:FilmDirectorDetailPage component,personApi module,movieApi module
•	Backend:PersonController,person Model,movie Model

Hình 3.66.Sơ đồ Class Diagram rút gọn chi tiết đạo diễn
3.3.Thiết kế cơ sở dữ liệu
Khái niệm
Hệ thống sử dụng MongoDB (NoSQL) dữ liệu được tổ chức theo collection.Việc thiết kế schema được định hướng theo cách dữ liệu được truy vấn và hiển thị.Với cá dữ liệu cần đọc cùng nhau thường xuyên có thể nhúng (embed) để giảm số lần truy vấn với dữ liệu có khả năng dùng lại nhiều nơi hoặc cập nhật thường xuyên thì ưu tiên tham chiếu để hạn chế lặp và dễ đảm bảo nhất quán.
3.3.1.ERD/SCHEMA tổng thể
Các collection chính được mô hình hóa theo sơ đồ ERD/SCHEMA tổng thế (đặt ngay sau mục này).Mỗi document có trường _id đóng vai trò định danh duy nhất.Các quan hệ giữa collection được thể hiện bằng các trường dạng …Id ( ví dụ userId,movieId,showtimeId) nhằm liên kết dữ liệu theo hướng tham chiếu,phù hợp khi có dữ liệu có tính tái sử dụng và dễ mở rộng.

Hình 3.47. Sơ đồ ERD/Schema tổng thể của hệ thống
3.3.2.Các bảng collection thật trong hệ thống
Dựa theo ERD hiện tại hệ thống gồm các nhóm collection chính:
Nhóm xác thực
•	users (người dùng)
Nhóm nội dung trang chủ
•	movies,banners,events,articles,faqs
Nhóm nghiệp vụ rạp – đặt vé
•	cinemas,rooms,showtimes,seat_holds,orders,tickets,payments,vouchers,
combos,reviews
Nhóm vận hành – hệ thống
•	feedbacks,chat_sessions,chat_messages,audit_logs,system_settings
Bảng mô tả Collection user
STT	Tên trường (Field)	Kiểu dữ liệu	Mô tả	Ràng buộc
1	_id	ObjectId	Định danh người dùng	PK
2	email	string	Email đăng nhập	unique, required
3	passwordHash	String	Mật khẩu đã hash (bcrypt)	Optional (bắt buộc nếu authType=local)
4	name	String	Họ tên người dùng	Required
5	phone	String	Số điện thoại
6	role	String	Phân quyền tài khoản	Required, Default="user"
7	authType	String	Loại đăng nhập	Required, Default="local"
8	authId	String	ID từ OAuth (Google)	Optional (chỉ có khi authType != local)
9	isActive	Boolean	Trạng thái hoạt động	Required, Default=true
10	otpCode	String	Mã OTP xác thực	Optional
11	otpExpires	Date	Thời gian hết hạn OTP	Optional
12	createdAt	Date 	Thời điểm tạo tài khoản	Required, Default=now
13	updatedAt	Date	Thời điểm cập nhật gần nhất	Required, Default=now
Bảng mô tả Collection movies
STT	Tên trường (Field)	Kiểu dữ liệu	Mô tả	Ràng buộc
1	_id	ObjectId	Định danh phim	PK
2	title	String	Tên phim	Required, Unique, trim
3	slug	String	Slug URL từ title	Optional (tự sinh)
4	description	String	Mô tả phim	Required,trim
5	director	ObjectId	Đạo diễn 	Required
6	studio	String	Nhà sản xuất	Optional, trim
7	country	String	Quốc gia 	Default “Việt Nam”
8	actors[]	[ObjectId]	Danh sách diễn viên	Optional
9	duration	Number	Thời lượng (phút)	Required
10	ageRating	String	Phân loại độ tuổi	Enum: P/C13/C16/C18, Default="P"
11	genres[]	[ObjectId]	Danh sách thể loại	Optional
12	posterUrl	String	URL poster	Required
13	bannerUrl	String	URL banner 	Optional
14	trailerUrl	String	trailerUrl	Required
15	stills[]	Array<Object>	Ảnh gallery trong phim	Optional
16	stills[].url	String	URL ảnh still	Optional
17	stills[].caption	String	Chú thích ảnh still	Optional
18	releaseDate	Date	Ngày khởi chiếu	Required
19	endDate	Date	Ngày kết thúc chiếu	Default = null
20	status	String 	Trạng thái phim	Enum: NOW/COMING/STOP, Default="COMING"
21	rating	Number	Điểm đánh giá	Default=0, min=0, max=10
22	ratingCount	Number	Số lượt đánh giá	Default=0
23	viewCount	Number	Lượt xem	Default=0
24	createdAt	Date	Ngày tạo	Auto (timestamps)
25	updatedAt	Date	Ngày cập nhật	Auto (timestamps)
Bảng mô tả Collection banner
STT	Tên trường (Field)	Kiểu dữ liệu	Mô tả	Ràng buộc
1	_id	ObjectId	Định danh banner	PK
2	imageUrl	string	URL ảnh banner	Required
3	linkUrl	String	Link điều hướng khi click banner	Default=""
4	title	String	Tiêu đề banner	Optional, trim
5	position	Number	Thứ tự hiển thị	Default = 0
6	status	String	Trạng thái banner	Enum: ACTIVE/INACTIVE, Default="ACTIVE"
7	createdAt	Date	Ngày tạo	Auto (timestamps)
8	updatedAt	Date	Ngày cập nhật	Auto (timestamps)
Bảng mô tả Collection events
STT	Tên trường (Field)	Kiểu dữ liệu	Mô tả	Ràng buộc
1	_id	ObjectId	Định danh sự kiện/khuyến mãi	PK, Required, Auto-generated
2	title	String	Tên sự kiện/khuyến mãi	Required,trim
3	description	String	Mô tả ngắn sự kiện	Optional
4	bannerUrl	String	Ảnh banner của sự kiện	Optional
5	startAt	Date	Thời điểm bắt đầu	Required
6	endAt	Date	Thời điểm kết thúc	Required
7	createdAt	Date	Ngày tạo	Auto (timestamps)
8	updatedAt	Date	Ngày cập nhật	Auto (timestamps)
9	status	String	Trạng thái sự kiện	Enum: UPCOMING/ONGOING/ENDED, Default="UPCOMING"
Bảng mô tả collection cinemas
STT	Tên trường (Field)	Kiểu dữ liệu	Mô tả	Ràng buộc
1	_id	ObjectId	Định danh rạp	PK
2	name	String	Tên rạp	Required,Unique,trim
3	address	String	Địa chỉ rạp	Required, trim
4	city	String	Thành phố/khu vực của rạp	Required, trim, Default = "Hà Nội"
5	phone	String	Hotline rạp	Required, trim
6	description	String	Mô tả rạp (giới thiệu, tiện ích…)	Optional, trim
7	status	String	Trạng thái hoạt động của rạp	enum: OPEN/CLOSED/MAINTENANCE, Default = "OPEN"
8	createdAt	Date	Ngày tạo document	Auto (timestamps)
9	updatedAt	Date	Ngày cập nhật	Auto (timestamps)
Ghi chú quan hệ
•	cinemas có virtual populate: rooms (không lưu trực tiếp trong document).
rooms tham chiếu từ collection rooms qua khóa rooms.cinemaId → cinemas._id


Bảng mô tả collection Showtime
STT	Tên trường (Field)	Kiểu dữ liệu	Mô tả	Ràng buộc
1	_id	ObjectId	Định danh suất chiếu	PK
2	name	String	Tên rạp	Required,Unique,trim
3	movieId	ObjectId	Phim của suất chiếu	Required
4	cinemaId	ObjectId	Rạp của suất chiếu	Required
5	roomId	ObjectId	Phòng chiếu của suất chiếu	Required
6	startAt	Date	Thời gian bắt đầu chiếu	Required
7	endAt	Date	Thời gian kết thúc	Required
8	basePrice	Number	Giá vé cơ bản	Required
9	format	String	Định dạng suất chiếu	enum: 2D/3D/IMAX, Default = "2D"
10	maintenanceSeats[]	[String]	Danh sách ghế hỏng/bảo trì theo suất	Optional
11	status	String	Trạng thái suất chiếu	enum: OPEN/CLOSED/CANCELED, Default = "OPEN"
8	createdAt	Date	Ngày tạo 	Auto (timestamps)
9	updatedAt	Date	Ngày cập nhật gần nhất	Auto (timestamps)
Index & ràng buộc
•	Compound unique index: { roomId: 1, startAt: 1 } unique
→ đảm bảo không có 2 suất chiếu trùng giờ bắt đầu trong cùng 1 phòng.
•	Ràng buộc nghiệp vụ chống chồng lịch: ngoài unique index trên, tầng Controller/Service cần check overlap giữa [startAt, endAt] của các suất trong cùng roomId để tránh trường hợp khác startAt nhưng vẫn chồng thời gian.

3.3.3.Khóa chính,ngoại khóa (logic) index và ràng buộc dữ liệu
Khóa chính:
•	MongoDB tự sinh _id:ObjectId cho mỗi document để đảm bảo định danh duy nhất.
Khóa ngoại:
•	MongoDB không ép ràng buôc FK như CSDL quan hệ,nên hệ thống quy ước các trường … Id để tham chiếu và kiểm soát ở tầng Servicce/Repository bằng kiểm tra tồn tại trước khi tạo liên kết.
Index & ràng buộc:
•	Dùng unique index cho các thuộc tính định danh để chống trùng ( ví dụ email,slug,orderNo,ticketCode…)
•	Dùng index theo mẫu truy vấn (lọc theo status / ngày chiếu / rạp…) để tối ưu hiển thị.
•	Dữ liệu tạm (như seat_holds) phù hợp cùng TTL index để tự hết hạn,tránh kẹt dữ liệu.
3.3.4. Giải pháp tránh trùng lặp dữ liệu
Mục tiêu của phần này là giảm lặp không cần thiết,nhưng vẫn cho phép lặp có chủ đích khi nó phục vụ hiệu năng hoặc lưu vết lịch sử nghiệp vụ.Theo nguyên tắc data modeling của MongoDB việc chọn embed hay reference phụ thuộc vào cách hệ thống đọc/ghi dữ liệu.
1)	Ưu tiên “reference” cho dữ liệu dùng lại nhiều nơi
•	Với các thực thể trung tâm như User /Movie /Cinema nhiều phân hệ cùng dùng (đặt vé,đánh giá,quản trị…) nên các collection nghiệp vụ chỉ lưu userId / movieId /cinemaId thay vì copy toàn bộ thông tin User / Movie  / Cinema.
•	Cách này giúp tránh lặp dữ liệu và giảm rủi ro mỗi nơi một kiểu khi cập nhất thông tin (ví dụ đổi tên rạp,đổi poster phim).
2)	Chỉ “embed” khi dữ liệu cần hiển thị cùng nhau thường xuyên
•	Nếu một cụm dữ liệu gần như luôn được đọc cùng nhau trong một màn hình/lần truy vấn, có thể nhúng để giảm số lần truy vấn.
•	Tuy nhiên nhúng chỉ nên áp dụng khi dữ liệu con không thay đổi quá thường xuyên hoặc kích thước phù hợp để tránh document phình lớn.
3)	Lặp có chủ đich theo kiểu snapshot cho dữ liệu lịch sử (không làm sai nghiệp vụ)
•	Với các bản ghi mang tính “chốt lịch sử” như orders/tickets hệ thống có thể lưu snapshot một số thông tin tại thời điểm đặt (ví dụ seatsSnapshot, combosSnapshot, giá tại thời điểm thanh toán).
•	Mục đích là đảm bảo về sau dù Movie/Combo đổi giá hoặc đổi tên thì đơn hàng cũ vẫn đúng theo lịch sử giao dịch; đây là dạng lặp dữ liệu có kiểm soát.
4)	Chống trùng bằng ràng buộc + quy trình ghi dữ liệu
•	Dùng unique index cho trường định danh (email, slug, orderNo, ticketCode…).
•	Khi tạo dữ liệu quan trọng, ưu tiên thao tác kiểu “kiểm tra tồn tại → tạo mới”, hoặc thiết kế API đảm bảo không tạo trùng do bấm nhiều lần (idempotent theo mã đơn/mã vé).
